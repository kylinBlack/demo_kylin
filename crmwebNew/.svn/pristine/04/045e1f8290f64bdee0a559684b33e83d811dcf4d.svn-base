<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    
    <script src="../../../../src/scripts/js/plug-in/drag/Sortable.min.js"></script>
    <link rel="stylesheet" href="../../../../src/css/cloud/menu/homePage/list.css">
    <link rel="stylesheet" href="../../../../src/css/cloud/menu/homePage/list_manager.css">

    <script type="text/javascript">
        function tableContextHandler(text){
            if(!text)
                text="";
            if(text.indexOf("http://")!=-1){
                try{
                    var fileList=JSON.parse(text);
                    if(fileList && fileList.length>0){
                        return tableContextHandlerFile(fileList);
                    }else if(fileList.value && fileList.value.length>0){
                        var urlList = JSON.parse(fileList.value);
                        return tableContextHandlerFile(urlList);
                    }
                }catch(e){
                }
            }
            return text;
        }

        function tableContextHandlerFile(fileList){
            var text='';
            $.each(fileList,function(i,obj){
                text+='<a tar href="'+obj.url+'" target="_blank" >'+obj.name+'</a>';
            });
            return text;
        }
    </script>

    <link rel="stylesheet" href="../../../../src/css/cloud/menu/homePage/tableList.css">
    <link href="../../../../src/css/common/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../src/css/cloud/menu/homePage/tableTeam.css">
    <style>
        body{
            width: 100%;
            height: 100%;
            background: #F4F4F4;
        }

        .bg-fff{
            background: #fff;
        }

        .bg-6fa7f5{
            background: #6fa7f5;
        }

        .bg-6fc7f5{
            background: #6fc7f5;
        }
        .bg-6ed4da{
            background: #6ed4da;
        }
        .bg-70dcbf{
            background: #70dcbf;
        }
        ul{
            margin: 0;
            padding: 0;
        }
        .page-container{
            height: 100%;
            width: 100%;
            margin-top: 10px;
        }

        .page-container-header{
            height: 40px;
            line-height: 40px;
            font-size: 16px;
        }

        .page-operate{
            float: right;
            height: 40px;
            line-height: 40px;
            margin-right: 20px;
        }

        .chart{
            position: absolute;
            top: 10px;
            right: 10px;
            bottom: 10px;
            left: 10px;
            border-radius: 10px;
            cursor: pointer;
        }

        .chart .chart-title{
            color: #fff;
            margin:20px ;
        }

        .chart .chart-number{
            color: #fff;
            text-align: center;
            font-size: 36px;
        }

        .chart .chart-nav{
            height: 40px;
            line-height: 40px;
            border-bottom: 1px solid #e2e1e1;
        }

        .chart .chart-nav .chart-operate{
            float: right;
            margin-right: 20px;
            color: #3b8cff ;
        }

        .chart .chart-nav .chart-operate .filter,.chart .chart-nav .chart-operate .setting{
            display: inline-block;
            height: 40px;
            line-height: 40px;
        }
        .chart .chart-nav .chart-nav-title{
            padding-left: 20px;
            font-size: 16px;
            float: left;
        }
        .chart .chart-nav .chart-nav-list{
            padding-left: 20px;
            display: inline-block;
        }
        .chart .chart-nav .chart-nav-list li{
            list-style: none;
            width: 80px;
            text-align: center;
            float: left;
        }
        .chart .chart-nav .chart-nav-list li:hover{
            color: #3b8cff;
            cursor: pointer;
        }
        .chart-container{
            padding: 10px;
        }

        .selected{
            color: #3b8cff;
            border-bottom: 1px solid #3b8cff;
        }
        .follow-up{
            position: absolute;
            top: 10px;
            right: 10px;
            bottom: 10px;
            left: 10px;
            background: #fff;
            border-radius: 10px;
            cursor: pointer;
        }
        .modal .modalColor {
            background: #48a1dd;
            color: #fff;
        }
        #configForm label{
            font-weight: normal;
        }
        .textCenter{
            text-align: center;
        }
        .require{
            color: #ff0000;
        }
        .presentation a{
            position: relative;
        }

        a:hover{
            text-decoration: none;
        }

        ul.panelContent li{
            position: relative;
        }
        ul.operate-panel{
            position:absolute;
            top: -25px;
            left:150px;
            width: 120px;
            list-style: none;
            background: #fff;
            z-index: 1001;
            border: 1px solid #eee;
        }
        ul.operate-panel li{
            height: 30px;
            line-height: 30px;
        }

        span#selectedPanel {
            display: inline-block;
            width: 100px;
            overflow: hidden;
        }

    </style>
    <link rel="stylesheet" href="/crmweb/assetsv1/js/searchFilter/style/searchFilter.css">


    <script type="text/javascript">
        // $.ajaxSetup({
        //     contentType: 'application/x-www-form-urlencoded;charset=utf-8',
        //     complete: function(xhr, status) {
        //         var sessionStatus = xhr.getResponseHeader('sessionstatus'); // 通过XMLHttpRequest取得响应头，sessionstatus，
        //         if (sessionStatus == "timeout") {
        //             location.href = ctx+'/common/logincloud.jsp';
        //         }
        //     }
        // });
        var openWindowMarker=false;
        var isUserAdmin=false;
        function openWindow(url,bakFun){
            openWindowMarker=true;
            window.openWindowBanFun=bakFun;
            $("#config_btn_panel").css({"width":"1100px","right":"0px"});
            $("#config_btn_panel").html('<div class="clearfix head-line" style="display: block;"><em class="back-btn" onclick="javascript:cloudOpenWindow();"></em></div><iframe width="100%" height="100%" scrolling="no" frameborder="0" src="'+url+'"></iframe>');
            $('#config_btn_panel').addClass('right-wrap-show animated fadeInRight');
        }
        function cloudOpenWindow(isSuccess){
            openWindowMarker=false;
            $("#config_btn_panel").removeClass("right-wrap-show fadeInRight");
            $("#config_btn_panel").animate({"right":"-1100px","opacity":"0.7"},600);
            $("#config_btn_panel").empty();
            if(isSuccess){
                if(window.openWindowBanFun){
                    window.openWindowBanFun();
                }
            }
        }
        function Notify(msg){
            tipsMsg(msg,"FAIL");
        }
    </script>
    <script data-require-id="echarts/chart/line" src="../../../../src/scripts/js/plug-in/echarts-2.2.7/chart/line.js" async=""></script>
    <script data-require-id="echarts/chart/bar" src="../../../../src/scripts/js/plug-in/echarts-2.2.7/chart/bar.js" async=""></script>
    <script data-require-id="echarts/chart/pie" src="../../../../src/scripts/js/plug-in/echarts-2.2.7/chart/pie.js" async=""></script>
</head>

<body id="body" class="" style="">

<div class="modal fade" id="managerHomePage" tabindex="-1" role="dialog" aria-labelledby="addClassModalLabel" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header modalColor">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h5 class="modal-title" id="addClassModalLabel">
                    <span>
                        <img class="middle" src="../../../images/searchFilter/set_icon.png" alt="设置分类">
                        <span class="middle">设置分类</span>
                    </span>
                </h5>
            </div>
            <div class="modal-body">
                <div class="action" style="padding-top: 0;height: 40px;">
	                            <span class="pointer pl6" data-toggle="modal" data-target="#addConditionModal" onclick="resetConditionModal();">
	                                <span onclick="javascript:window.location.href='./definedPageEdit.html';">
                                        <img class="middle" src="../../../images/searchFilter/add-selete.png" alt="添加首页">
	                                    <span class="middle">添加首页</span>
	                                </span>
	                            </span>
                </div>
                <input type="hidden" id="tableConditionSettingId">
                <table id="homePageTable" class="connectedSortable ui-sortable" style="width: 100%" border="0" cellspacing="0" cellpadding="0">
                    <thead>
                    <tr bgcolor="#e4e8ec" class="ui-sortable-handle" style="">
                        <td>名称</td>
                        <td>是否显示</td>
                        <td>设置为默认</td>
                        <td>操作</td>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="modal-footer textCenter">
                <button type="button" class="btn btn-primary" onclick="javascript:submit();">保存</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

<!-- 右侧隐藏面板 -->
<div class="page-container" id="divparent">
    <div class="row">
        <div class="col-xs-6 showLink">
            <div class="dropdown homePageMenu" style="display: inline-block;margin-left: 10px;cursor: pointer;min-width: 400px;">
                <a data-toggle="dropdown" href="javascript:void(0);" class="btn btn-default select-panel" style="min-width: 160px; text-align: left;background: #fff;" aria-expanded="false">
                    <span id="selectedPanel" class="pagePortalThemes" value="" title="test列表显示" key_id="1097318919737184256">test列表显示</span>
                    <i class="" style="position: absolute; top:10px;left:120px;font-size:16px">
                        <i class="fa fa-angle-down" href="javascript:void(0);" style="margin-left:15px"></i>
                    </i>
                </a>
                <ul class="dropdown-menu panelContent selectPanel" role="menu" aria-labelledby="dropdownMenu1"></ul>
                <span class="show-panel-operate" style="display: none;">
                    <a class="fa fa-plus" id="newPanel" href="./definedPageEdit.html"  style="margin-left:15px">&nbsp;添加面板</a>
                    <a class="fa fa-cog" id="managerPanel" style="margin-left:15px">&nbsp;管理面板</a>
                </span>
            </div>
        </div>
    </div>
    <div id="parentContext"></div>
</div>
<div class="right-wrap new-right-wrap before-right-wrap" id="config_btn_panel" style="z-index: 101;">
</div>

#include("../../components/common.html")

<script type="text/javascript" src="../../../../src/scripts/js/cloud/menu/home_page.js"></script>

<!-- <script type="text/javascript">
    var saveFormBackFunList = [];
    var sqlSavnSaveAfterHander=[];
    var fieldList,buttonList,tableSetting,configId;var fieldTypeList;var conditionList={};var buttonConfigList={};
    var tableConfigObj={};
    var tableDbRows={};
    var form_pm_obj={};
    var form_db={};
    var sys_db={};
    function searchTable(me){
        me=$(me);
        var idKey=me.attr("key_mark");
        var fieldKeys=[];
        var fieldList=tableConfigObj[idKey+"_fieldList"];
        if(fieldList && fieldList.length>0){
            $.each(fieldList,function(i,obj){
                if(obj.isSearch && obj.isSearch==1){
                    fieldKeys.push(obj.columnName);
                }
            });
        }
        var keyword=me.parent().find("input[name=fb_keyword]").val();
        var data={keyword:keyword,fieldKeys:JSON.stringify(fieldKeys)};
        if(tableConfigObj[idKey]){
            tableConfigObj[idKey].jqGrid('setGridParam',{datatype:'json',postData:data,page:1}).trigger("reloadGrid"); //重新载入  
        }
    }

    function initConfig(configDiv,config,orderMark){
        this.config = config;
        this.paramsValue=config.paramsValue;
        this.contentType=config.comType;
        this.objectId=config.dataSource;
        this.configDiv=configDiv;
        this.orderMark=orderMark;
        this.idKey =  'from_table_field_mark_'+(this.objectId+'_'+this.orderMark);
        var me = this;
        this.init=function(){
            if(this.contentType && this.objectId) {
                if("TABLE_TEAM"==this.contentType){
                    var url = ctx+"/cloud/menu/tableTeam/"+this.objectId;
                    configDiv.html('<iframe width="100%" scrolling="no" frameborder="0"  src="'+url+'" height="100%"></iframe>');
                }else if("NUMBER"==this.contentType){
                    configDiv.html(
                            '<div class="chart bg-6fa7f5">'+
                            '<div class="chart-title">'+(this.config.name)+'</div>'+
                            '<div class="chart-number" name="digital">0</div>'+
                            '</div>'
                    );
                    initDigital(this.config,this.configDiv);
                }else if("LIST"==this.contentType){
                    configDiv.html('<div class="list_component"></div>');
                    var config={id:this.config.dataSource,params:this.config.params,markId:(this.orderMark+"-"+this.config.dataSource),w:this.config.w,h:this.config.h};
                    config['openWindow']=openWindow;
                    config['cloudOpenWindow']=cloudOpenWindow;
                    var list = new tableList($(configDiv.find('.list_component')[0]),config);
                    list.init();
                }else if("PIE"==this.contentType || "BAR"==this.contentType || "LINE"==this.contentType){
                    var chartHeight=150*(this.config.h*1);
                    var html ='<div class="chart bg-fff">'+
                            '<div class="chart-nav">'+
                            '<div class="chart-operate">'+
                            '<span class="filter" key="filter_btn">'+
                            '<a class="fa fa-filter" href="javascript:void(0);" style="margin-left:15px"></a>'+
                            '<span style="padding-left: 6px;">筛选</span>'+
                            '</span>'+
                            '<span class="setting"  key="setting_btn" style="padding-left: 10px;">'+
                            '<a class="fa fa-cog" href="javascript:void(0);" style="margin-left:15px"></a>'+
                            '</span>'+
                            '</div>'+
                            '<span class="chart-nav-title">'+(this.config.name)+'</span>'+
                            '<ul class="chart-nav-list">'+
                            '</ul>'+
                            '</div>'+
                            '<div class="filterDiv"></div>'+
                            '<div class="chart-container" id="'+(this.idKey)+'" style="height:'+(chartHeight-60)+'px;">'+
                            '</div>'+
                            '</div>';
                    configDiv.html(html);
                    var refere=encodeURIComponent(window.location.href);
                    var chart = new chartInit(this.idKey,this.config);
                    chart.init();
                }
            }else {
                if ("ASSESS" == this.contentType) {
                    var tempHtml = this.configDiv.find(".freemarkerTemplate").html();
                    if (tempHtml) {
                        tempHtml = decodeURIComponent(tempHtml);
                    }
                    var data = getParamsObj(paramsValue);
                    data['html'] = tempHtml;
                    $.post(ctx + "/cloud/sys/assess/getHtml", data, function (json) {
                        if (json.ret == "0") {
                            me.configDiv.html(json.html);
                            initOpenForm(me.configDiv);
                        } else {
                            me.configDiv.html(json.msg);
                        }
                    });
                }
            }
        };

        /*初始化数字组件*/
        function initDigital(config,configDiv){
            configDiv.find("[name=digital]").bind("click",function(me){
                window.parent.openUrl('/crmweb/cloud/menu/tablelist/'+tableId+"?"+paramsValue,"1",configDiv.find("[name=title]").text(),tableId);
            });
            var  data={tableId:config.dataSource,field:("count(*)"==config.countFiled)?"":config.countFiled};
            $.post(ctx+'/cloud/table/list/reader/digital',data,function(data){
                configDiv.find("[name=digital]").text(data.total);
            });
        };

        /*初始化表单*/
        function initForm(){

        };
        /*初始化报表*/
        function initReport(me,tableId,idKey,configDiv,paramsValue){
            configDiv.find(".set-table-btn").bind("click",function(me){
                openWindow('/crmweb/new/menu/setting.jsp?tableId='+tableId+'&type='+table_setting_type+"&hinedHeight=true&showHidePage=true");
            });
            $.ajax({
                type : "post",
                url : ctx+"/cloud/userUiConfig/postGet",
                data :{module:tableId,type:table_setting_type},
                async : false,
                success : function(json){
                    if(json.result=="Success" || json.result=="SUCCESS"){
                        var jsonMap=json.map;
                        fieldList = jsonMap.fieldList;
                        buttonList = jsonMap.buttonList;
                        configId=jsonMap.configId;
                        tableSetting=jsonMap.tableSetting;
                        var fieldList = jsonMap.fieldList;
                        var buttonList = jsonMap.buttonList;
                        var colList=[];
                        var editDelButtonList = [];
                        if(buttonList!=null && buttonList.length>0){
                            $.each(buttonList,function(i,button){
                                buttonConfigList[button.sid]=button;
                                if(button.type=="ADD"){
                                    var class_val = JsonButton.spanButton.default_btn_select;
                                    if(button.style){
                                        var mesg = ctx+"/assetsv1/img/list/"+button.style+"_white.png";
                                    }
                                    configDiv.find(".button_content").append(
                                            '<span id="add_entry" key_id="'+button.sid+'" onclick="javascript:clickButton(this,\''+idKey+'\');" class="default-btn '+class_val+'" type="button"  style="margin: 0px 5px;background:rgba(72, 160, 220, 1) url('+mesg+') no-repeat 10px center" >'+button.name+'</span>'
                                    );
                                }else{
                                    if(button.type!="LINK") {
                                        editDelButtonList.push(button);
                                    }
                                }
                            });
                        }
                        $.each(fieldList,function(i,field){
                            var title=field.title;
                            if(field.alias && field.alias.length>0){
                                title=field.alias;
                            }
                            var colObj = {label:title,index:field.columnName,name:field.columnName};
                            if(!field.isShow && field.isShow==0){
                                colObj['hidden']=true;
                            }
                            if(field.primaryKey && field.primaryKey==1){
                                colObj['key']=true;
                            }
                            if(field.fieldType=="DATE" || field.fieldType=="DATETIME" || field.fieldType=="TIME"){
                                var format="yyyy-MM-dd";
                                if(field.fieldType=="DATETIME"){
                                    format="yyyy-MM-dd HH:mm:ss";
                                }else if(field.fieldType=="TIME"){
                                    format="HH:mm:ss";
                                }
                                colObj['formatter']=function(v,x,n){
                                    if(v){
                                        var date=new Date(v);
                                        return textBZ(idKey,date.format(format),field.columnName, x.rowId,n,buttonList);
                                    }
                                    return textBZ(idKey,v,field.columnName, x.rowId,n,buttonList);;
                                }
                            }else{
                                colObj['formatter']=function(dbValue,x,n){
                                    return textBZ(idKey,dbValue,field.columnName, x.rowId,n,buttonList);
                                }
                            }
                            colList.push(colObj);
                        });
                        if(editDelButtonList.length>0){
                            colList.push({
                                label:"操作",
                                index:"操作",
                                name:"操作",
                                formatter:function(dbValue,x,n){
                                    var buttonStr='';
                                    $.each(editDelButtonList,function(i,button){
                                        if(n.SHOW_BUTTON_IDS && existString(n.SHOW_BUTTON_IDS,button.sid)){
                                            var class_val = JsonButton.spanButton.default_btn_select;
                                            if(button.style){
                                                var mesg = ctx+"/assetsv1/img/list/"+button.style+"_white.png";
                                            }
                                            buttonStr+='<span id="add_entry" key_id="'+button.sid+'" row_id="'+ x.rowId+'" bt_type="'+button.type+'" onclick="javascript:clickButton(this,\''+idKey+'\');" class="default-btn '+class_val+'" type="button"  style="margin: 0px 5px;background:rgba(72, 160, 220, 1) url('+mesg+') no-repeat 10px center" >'+button.name+'</span>'
                                        }
                                    });
                                    return buttonStr;
                                }
                            });
                            //showColCount++;
                        }
                        var parentObj=configDiv.closest(".set_height_mark");
                        var mark_height;
                        if(parentObj){
                            var  height=parentObj.height()-110;
                            if(height>0){
                                mark_height = height;
                            }
                        }
                        var pager_mark;
                        if(!(tableSetting && tableSetting.isShowPage==0)){
                            pager_mark="#"+me.idKey+"_pager";
                        }else{
                            if(height>0){
                                height=height+35;
                            }
                        }
                        gridObj=configDiv.find(".tableObj").jqGrid({
                            url: ctx+'/cloud/table/list/reader/list',
                            mtype: "POST",
                            styleUI : 'Bootstrap',
                            datatype: "json",
                            scrollrows: true,//行可见,
                            postData:{tableId:tableId},
                            gridComplete:function(){
                            },
                            colModel: colList,
                            viewrecords: true,
                            height:mark_height,
                            rowNum: 20,
                            pager:pager_mark,
                            rownumbers: true,
                            autowidth: true,
                            scroll: false,
                            paramsFun:function(){
                                var data=getParamsObj(paramsValue);
                                if(form_pm_obj){
                                    for (var pd in form_pm_obj) {
                                        if (form_pm_obj[pd]) {
                                            data[pd]=form_pm_obj[pd];
                                        }
                                    }
                                }
                                if(form_db){
                                    for (var pd in form_db) {
                                        if (form_db[pd]) {
                                            data[pd]=form_db[pd];
                                        }
                                    }
                                }
                                return data;
                            },
                            loadComplete:function(data) {
                                tableDbRows[idKey]=data.rows;
                            }
                        });
                        tableConfigObj[idKey]=gridObj;
                        tableConfigObj[idKey+"_fieldList"]=fieldList;

                        function textBZ(idKey,text,fieldKey,rowId,data,buttonList){
                            if(text){
                                if(typeof text=="object"){
                                    text=JSON.stringify(text);
                                }
                                text=text+"";
                                if(text.indexOf("###")!=-1){
                                    text=text.replace("###","");
                                    text = JSON.parse($.trim(text));
                                    var iconStr="";
                                    if(text.icon){
                                        iconStr="<label class='"+text.icon+"'></label>";
                                    }
                                    var styleStr="";
                                    if(text.background && text.background.toLowerCase()!="#ffffff"){
                                        styleStr="style='color:"+text.background+";'";
                                    }
                                    if(text.change_text){
                                        return  iconStr + '<label key_change="1" rowId="'+rowId+'" key_value="'+text.value+'" '+styleStr+'>'+text.change_text+"</label>"
                                    }
                                }
                                //处理超链接
                                if(buttonList && buttonList.length>0){
                                    $.each(buttonList,function(i,obj){
                                        if(obj.type=="LINK" && obj.name==fieldKey){
                                            if(data.SHOW_BUTTON_IDS && data.SHOW_BUTTON_IDS.length>0){
                                                for(var mk in data.SHOW_BUTTON_IDS){
                                                    if(data.SHOW_BUTTON_IDS[mk]==obj.sid){
                                                        text='<a key_id="'+obj.sid+'" onclick="javascript:clickButton(this,\''+idKey+'\');" bt_type="LINK" type="button" row_id="'+rowId+'">'+text+'</span>'
                                                    }
                                                }
                                            }
                                        }
                                    });
                                }
                            }
                            return tableContextHandler(text);
                        }
                    }else{
                        tipsMsg(json.resultMsg,"FAIL");
                    }
                }
            });
        };
        /*初始化图标*/
        function initChart(){
        };
        function columnSet(options,buttonList,idKey){
            if(options.items==undefined || options.items==null || options.items=="" || options.items.length==0){
                alert("请添加items设置项");
                return ;
            }
            db_items=options.items;
            var col_attr=[];
            var columns=[];
            for(var i=0;i<db_items.length;i++){
                var item = db_items[i];
                if(item.propcn==="表头互选字段root_field_id"){
                    columns[columns.length]={
                        "sTitle": "<input title='全选' type='checkbox' class='group-checkable' value='0' name='bootstarp_data_table_checkbox'>",
                        "sClass": "left selected",
                        "bVisible": true,
                        "sWidth": "2%",
                        "bSortable": false,
                        "bSearchable": false,
                        "mData":item.prop,
                        "mRender": function(value) {
                            return "<input title='选择' type='checkbox' key='root_checkbox' class='checkboxes' name='bootstarp_data_table_checkbox' value='"+value+"'>";
                        }
                    }
                    col_attr.push({});
                    break;
                }
            }
            $.each(options.items,function(i,v) {
                if (v.isShow) {
                    if (v.propcn != "表头互选字段root_field_id") {
                        col_attr.push({format: v.format, v: v});
                        columns[columns.length] = {
                            data: v.prop,
                            sTitle: v.propcn,
                            bSortable: v.isSort,
                            "mRender": function (dbValue, a, b, c) {
                                var vobj = col_attr[c.col].v;
                                var html = fieldMRender(dbValue, vobj);
                                var isHtml =(html && (html+"").indexOf("<div")!=-1)?true:false;
                                html = getLinkText(vobj.prop, html, c.row,buttonList);
                                if (vobj.htmlType == "UPPICTURE" || vobj.htmlType == "UPFILE" || isHtml) {
                                    return html;
                                } else {
                                    return dataTableTitle(html);
                                }
                            }
                        };
                    }
                }
            });
            if(buttonList && buttonList.length>0){
                var buttonCount = 0;
                for(var i=0;i<buttonList.length;i++){
                    var button=buttonList[i];
                    if(button.buttonType!="ADD"){
                        buttonCount++;
                    }
                }
                if(buttonCount>0){
                    columns[columns.length]={
                        data: function (item,a,b,c,d) {
                            var row = c.row;
                            var tempDiv = $("<div/>");
                            initButton("2",item.judge_show_button_ids,tempDiv,buttonList,idKey);
                            var html = tempDiv.html();
                            html=html.replace(/11=\"11\"/g,"onclick='javascript:button_click(this,"+row+");'");
                            if(tempDiv.find("[complate_key='button']").length>3){
                                return '<a href="javascript:void(0);" key="more_button_event" class="btn btn-default opt" ><i class="fa fa-edit"></i></a><div style="display:none;" key="more_button">'+html+'</div>';
                            }else{
                                return html;
                            }
                        },
                        bSortable: false,
                        bSearchable: false,
                        title:"操作"
                    };
                }
            }
            columns[columns.length]={data:idKey,sTitle:idKey,visible:false};
            return columns;
        }
        function initButton(type,showIds,divObj,buttonListJson,idKey){
            if(buttonListJson && buttonListJson.length>0){
                for(var i=0;i<buttonListJson.length;i++){
                    var bojb = buttonListJson[i];
                    if(bojb.buttonType=="LINK"){
                        continue;
                    }
                    if((type=="1" && bojb.buttonType=="ADD") || (type=="2" && bojb.buttonType!="ADD")){
                        if(showIds && showIds.length>0){
                            var showIdsValue= showIds.split(",");
                            var isShow=false;
                            for(var j=0;j<showIdsValue.length;j++){
                                if(bojb.definedListButtonId==showIdsValue[j]){
                                    isShow=true;
                                    break;
                                }
                            }
                            if(!isShow)
                                continue;
                        }
                        var buttonObj = getButton(bojb.definedListButtonId,bojb,idKey);
                        if(buttonObj){
                            if(type=="1"){
                                divObj.prepend(buttonObj);
                            }else{
                                divObj.append(buttonObj);
                            }
                        }
                    }
                }
            }
        }
    };


    function getButton(id,button,idKey){
        var buttonTemplate = '';
        if(button && button.buttonCssTemplate){
            buttonTemplate=$(button.buttonCssTemplate);
        }else{
            buttonTemplate=$('<button  complate_key="button"  class="btn btn-darkorange btn-sm"  11="11" button_template_id="'+button.definedListButtonId+'"><i class="fa fa-plus"></i> '+button.buttonText+'</button>');
        }
        buttonTemplate.attr("complate_key","button");
        buttonTemplate.attr("button_type",button.buttonType);
        buttonTemplate.attr("link_address",button.linkAddress);
        buttonTemplate.attr("params_keys",button.paramsFieldList);
        buttonTemplate.attr("touchObject",button.touchObject);
        buttonTemplate.attr("buttonPopType",button.buttonPopType);
        buttonTemplate.attr("touchObjectId",button.touchObjectId);
        buttonTemplate.attr("tableId",button.extendConfigTableId);
        buttonTemplate.attr("buttonText",button.buttonText);
        buttonTemplate.attr("keyId",idKey);
        return buttonTemplate;
    }

    var cuurent_key_id;
    function button_click(thisObj,row,pm){
        var me = $(thisObj);
        var buttonType = me.attr("button_type");
        var touchObject=me.attr("touchObject");
        var params_keys=me.attr("params_keys");
        var tableId=me.attr("tableId");
        var button_text = me.attr("buttonText");
        var keyId = me.attr("keyId");
        var rowData,extend_field_extend_table_id;
        var data={};
        cuurent_key_id=keyId;
        if(keyId){
            var tableObj=tableConfigObj[keyId].table;
            if(tableObj && (row || row==0)){
                var nTrs = tableObj.fnGetNodes();//fnGetNodes获取表格所有行，nTrs[i]表示第i行tr对象
                rowData= tableObj.fnGetData(nTrs[row]);
                if(rowData && rowData['extend_field_extend_table_id']){
                    extend_field_extend_table_id=rowData['extend_field_extend_table_id'];
                }
            }
            if(tableConfigObj[keyId].params){
                valueToCopay(tableConfigObj[keyId].params,data);
            }
            data["rfs_value"]=getRootFieldSelectValue(keyId);
            data['extend_field_extend_table_id']=extend_field_extend_table_id;
        }
        if(params_keys){
            params_keys= $.trim(params_keys);
            var keys =params_keys.split(",");
            if(rowData){
                for(var i=0;i<keys.length;i++){
                    var key = $.trim(keys[i]);
                    var name=key;
                    var field_key=key;
                    if(key.split("=").length>1){
                        name=key.split("=")[0];
                        field_key=key.split("=")[1];
                    };
                    if(key){
                        data[name]=rowData[field_key];
                    };
                };
            }
            console.log('[获取数据]' +rowData);//fnGetData获取一行的数据
        }
        if("FORM"==me.attr("touchObject")){
            var formId=me.attr("touchObjectId");
            if(me.attr("buttonPopType")==0){
                defined_form.handlerDefined("content_div",formId,tableId,data,function(){
                    $('#myModal1').modal();
                    $('#myModal1').find(".modal-title").html(button_text);
                    if(extend_field_extend_table_id){
                        $("#content_div").append($("<input type='hidden'  key='extend_element' value='"+extend_field_extend_table_id+"' type='text' name='extend_field_extend_table_id'>"));
                    }
                });
            }else{
                var url = ctx+"/cloud/defined/from/db/toForm?formId="+formId+"&formDB="+JSON.stringify(data)+"&title_page="+button_text;
                window.parent.openSecondPage(url,document.title);
            }
        }else if("SQLSAVE"==me.attr("touchObject")){
            if(buttonType=="DELETED"){
                bootbox.confirm({
                    buttons: {
                        confirm: {label: '确定',className: 'btn-primary'},
                        cancel: {label: '取消',className: 'btn-default'}
                    },
                    message: '是否确认'+button_text,
                    callback: function(result) {
                        if(result) {
                            var sqlSaveEnterId=me.attr("touchObjectId");
                            $(".loading").show();
                            $.post(ctx+"/cloud/defined/from/db/sqlsave/"+sqlSaveEnterId,data,function(json){
                                $(".loading").hide();
                                if(json.result=="SUCCESS"){
                                    Notify(button_text+'成功', 'top-right', '5000', 'success', 'fa-check', true);
                                    $('#myModal1').modal("hide");
                                    oTable.fnClearTable(0);
                                    oTable.fnDraw();
                                }else{
                                    Notify(json.resultMsg, 'top-right', '5000', 'danger', 'fa-bolt', true);
                                }
                            });
                        }
                    }
                });
            }else{
                var sqlSaveEnterId=me.attr("touchObjectId");
                $(".loading").show();
                $.post(ctx+"/cloud/defined/from/db/sqlsave/"+sqlSaveEnterId,data,function(json){
                    $(".loading").hide();
                    if(json.result=="SUCCESS"){
                        Notify(button_text+'成功', 'top-right', '5000', 'success', 'fa-check', true);
                        $('#myModal1').modal("hide");
                        oTable.fnClearTable(0);
                        oTable.fnDraw();
                    }else{
                        Notify(json.resultMsg, 'top-right', '5000', 'danger', 'fa-bolt', true);
                    }
                });
            }
        }else if("EXTENTTABLE"==me.attr("touchObject") || "REPORT"==me.attr("touchObject")){
            var touchObjectId=me.attr("touchObjectId");
            config.menuId=touchObjectId;
            config.type="TABLELIST";
            var con="";
            var contentId="";
            if(data){
                for(var p in data){
                    contentId=contentId+data[p];
                    if(con){
                        con=con+"&"+p+"="+data[p];
                    }else{
                        con=p+"="+data[p];
                    }
                }
            }
            var url = ctx+"/cloud/defined/extendtable/list/"+touchObjectId+"?showSearch=true&showButton=true&"+con;
            if("REPORT"==me.attr("touchObject")){
                url =  ctx+"/cloud/defined/report/list/"+touchObjectId+"?showSearch=true&showButton=true&"+con;
            }
            var title = button_text;
            if(me.attr("button_type")!='LINK'){
                title=title+"-"+(contentId.length>6?contentId.substring(0,6)+"...":contentId);
            }
            url = url +"&title_page="+title;
            window.parent.openSecondPage(url,document.title);
        }else if("CUSTOMERSECONDPAGE"==me.attr("touchObject")){
            var title =me.html();
            var con="";
            var contentId="";
            if(data){
                for(var p in data){
                    contentId=contentId+data[p];
                    if(con){
                        con=con+"&"+p+"="+data[p];
                    }else{
                        con=p+"="+data[p];
                    }
                }
            }
            var url = "/crmweb/cloud/patient/customerDetail1?"+con;
            url = url +"&title_page="+title;
            var rowDbJson=getRowData(rowData);
            if(rowDbJson && rowDbJson.length>0){
                localStorage.setItem("rowDatas",rowDbJson);
            }
            window.parent.openSecondPage(url,document.title);
        }else if( "ADDRESS"==me.attr("touchObject")){
            var title =me.html();
            var con="";
            var contentId="";
            if(data){
                for(var p in data){
                    contentId=contentId+data[p];
                    if(con){
                        con=con+"&"+p+"="+data[p];
                    }else{
                        con=p+"="+data[p];
                    }
                }
            }
            var buttonPopType=me.attr("buttonPopType");
            var link_address=me.attr("link_address")+"?"+con;
            url = link_address;
            url=url.replace("{ctx}",ctx);
            if(me.attr("buttonPopType")==0){
                $('#openAddress').modal();
                $('#openAddress').find(".modal-title").html(title);
                $("#openAddress").find("[key=content_div]").html("<iframe width='100%' height='100%' src='"+url+"'>");
            }else{
                url = url +"&title_page="+title;
                window.parent.openSecondPage(url,document.title);
            }
        }
    }

    function existString(idList,id){
        if(idList && idList.length>0){
            for(var i=0;i<idList.length;i++){
                if(idList[i] == id){
                    return true;
                }
            }
        }
    }

    function getParamsObj(pmStr){
        var pm = {};
        if(pmStr && pmStr.length>0){
            for(var i=0;i<pmStr.length;i++){
                var pms = pmStr.split("&");
                if(pms && pms.length>0){
                    for(var z=0;z<pms.length;z++){
                        var pobj=pms[z];
                        if(pobj && pobj.indexOf("=")!=-1){
                            var pobjS = pobj.split("=");
                            if(pobjS && pobjS.length==2){
                                var key = $.trim(pobjS[0]);
                                var value = $.trim(pobjS[1]);
                                if(key && value){
                                    pm[key]=value;
                                }
                            }
                        }
                    }
                }
            }
        }
        return pm;
    }
    var currentOpenObj = {};
    function openFormBack(){
        if(currentOpenObj.formId){
            if(currentOpenObj.after_save_html && currentOpenObj.divObj){
                var nameS = currentOpenObj.after_save_html.split(",");
                var htmlValue = "";
                for(var i=0;i<nameS.length;i++){
                    var name = $.trim(nameS[i]);
                    if(name){
                        var value = $($("#content_div").find("[name="+name+"]")[0]).val();
                        if(value){
                            htmlValue+=value;
                        }
                    }
                }
                if(currentOpenObj.divObj.find("input").length==1){
                    $(currentOpenObj.divObj.find("input")[0]).val(htmlValue);
                }else{
                    currentOpenObj.divObj.html(htmlValue);
                }
            }
            if(currentOpenObj.after_save_refursh_table){
                if(tableConfigObj){
                    var tableObj ;
                    for(var cobj in tableConfigObj){
                        if(cobj.indexOf("from_table_field_mark_"+currentOpenObj.after_save_refursh_table)!="-1"){
                            tableObj=tableConfigObj[cobj];
                            break;
                        }
                    }
                    if(tableObj){
                        tableObj.table.fnClearTable(0);
                        tableObj.table.DataTable().draw(false);
                    }
                }
            }
        }
    }


    function initOpenForm(divObj){
        divObj.find("[key_type='openForm']").each(
                function(i,obj){
                    $(obj).bind("click",function(){
                        var obj = $(this);
                        var formId =obj.attr("key_form_id");
                        var pm = obj.attr("key_pm");
                        var formTitle = obj.attr("key_form_title");
                        var after_save_html=obj.attr("after_save_html");
                        var after_save_refursh_table=obj.attr("after_save_refursh_table");
                        currentOpenObj={formId:formId,pm:pm,formTitle:formTitle,after_save_html:after_save_html,after_save_refursh_table:after_save_refursh_table,divObj:obj};
                        if(formId){
                            var pmObj=getParamsObj(pm);
                            if(obj.find("input").length==1){
                                pmObj['htmlValue'] = $.trim($(obj.find("input")[0]).val());
                            }else{
                                pmObj['htmlValue'] = $.trim(obj.html());
                            }
                            defined_form.handlerDefined("content_div",formId,0,pmObj,function(){
                                $('#myModal1').modal();
                                $('#myModal1').find(".modal-title").html(formTitle);
                                $("#content_div").append($("<input type='hidden'  key='extend_element' value='1' type='text' name='openFormMark'>"));
                            });
                        }
                    });
                }
        );
    }

    var currentFB_Label_MARK;
    function setCurrentFBLabelMARK(mark){
        currentFB_Label_MARK=mark;
    }
    function getCurrentFBLabelMARK(){
        return currentFB_Label_MARK;
    }


    function submitScoreV1(me){
        var me = $(me);
        var sqlsave_id = me.attr("sqlsave_id");
        var parentDivId = me.attr("parent_div_id");
        var pm = me.attr("key_pm");
        var data=[];
        $("#"+parentDivId).find("input[key_type='blurSqlSave']").each(function(i,obj){
            obj = $(obj);
            var report_id=obj.attr("report_id");
            var item_id=obj.attr("item_id");
            var val= $.trim(obj.val());
            if(!val || !(/^[0-9]+$/.test(val))){
                val=0;
            }
            data.push(report_id+"|"+item_id+"|"+val);
        });
        var pmObj=getParamsObj(pm);
        pmObj['data']=data.join(",");
        $.post(ctx+"/cloud/defined/from/db/sqlsave/"+sqlsave_id,pmObj,function(json){
            if(json.result=="SUCCESS"){
                alert("保存成功");
            }else{
                Notify(json.resultMsg, 'top-right', '5000', 'danger', 'fa-bolt', true);
            }
        });
    }
</script> -->

<!-- <script type="application/javascript">
    function definedDecodeURIComponent(text){
        try{
            return decodeURIComponent(text);
        }catch(e){
            console.log(e);
            return text;
        }
    }
    var btf={
        button:{
            /**
             *
             * @param me 按钮对象
             * @param bak 按钮操作后的回调函数
             * @param buttonListObj 为按钮集合
             * @param dbData 数据对象 {table:{},form:{},sys:{}}  row 一般编辑按钮所在的 哪行数据 ，form 打开当前报表所传入的参数,sys 系统变量
             */
            clickButton:function(thisObj,buttonListObj,dbData,bak){
                var me = this;
                var id = $(thisObj).attr("key_id");
                if(buttonListObj[id]){
                    var button = buttonListObj[id];
                    if(button.setting){
                        var setting = JSON.parse(button.setting);
                        if(setting.trigger_type){
                            var display = setting.display;
                            var trigger_type=setting.trigger_type;
                            var trigger_id=setting.trigger_id;
                            var params=setting.params;
                            params=me.setParamsValue(params,dbData);
                            if(!params){
                                params={};
                            }
                            putStorageValue("to_params_value",JSON.stringify(params));
                            putStorageValue("y_params_value",JSON.stringify(dbData));
                            //FFORM等于REPORT
                            if("FORM"==trigger_type){
                                me.openForm(trigger_id,params,bak,display);
                            }else if("TABLE_LIST"==trigger_type || "REPORT"==trigger_type){
                                me.openTableList(trigger_id,params,display,bak,display);
                            }else if("SQLSAVE"==trigger_type){
                                me.openSqlSave(trigger_id,params,bak,display);
                            }else if("TABLE_TEAM"==trigger_type){
                                me.openTableTeam(trigger_id,params,bak,display);
                            }else if("PAGE_LAYOUT"==trigger_type){
                                me.openPageLayout(trigger_id,params,bak,display);
                            }else if("LINK_ADDRESS"==trigger_type){
                                me.openAddress(setting.trigger_name,params,bak,display);
                            }
                        }else{
                            tipsMsg("按钮触发对象类型为空","FAIL");
                        }
                    }else{
                        tipsMsg("按钮没有设置触发对象","FAIL");
                    }
                }else{
                    tipsMsg("按钮不存在","FAIL");
                }
            },setParamsValue:function(paramsList,dbData){
                var pmDB={};
                if(paramsList && paramsList.length>0){
                    for(var i=0;i<paramsList.length;i++){
                        var pm = paramsList[i];
                        if(pm.p_value){
                            var p_name = pm.p_name;
                            var p_value = pm.p_value;
                            var value  = p_value;
                            pmDB[p_name]=p_value;
                            if(p_value.indexOf(".")!=-1 && p_value.split(".").length==2){
                                var p_key = $.trim(p_value.split(".")[0]);
                                var c_key = $.trim(p_value.split(".")[1]);
                                if(dbData[p_key] && dbData[p_key][c_key]){
                                    value = dbData[p_key][c_key];
                                }else{
                                    value="";
                                }
                                pmDB[p_name]=value;
                            }
                        }
                    }
                }
                return pmDB;
            },openForm:function(trigger_id,params,bak,display){
                if(display && display=="skipPage"){
                    window.open(ctx+'/new/menu/form.jsp?formId='+trigger_id,'_blank');
                }else{
                    openWindow(ctx+'/new/menu/form.jsp?formId='+trigger_id,bak);
                }
            },openTableList:function(trigger_id,params,bak,display){
                var pmStr = (btf.getParamsStr(params));
                if(display && display=="skipPage"){
                    window.open(ctx+'/cloud/menu/tablelist/'+trigger_id+'?'+pmStr,'_blank');
                }else{
//                    $(".table_pop_window").show();
                    //这里添加弹框
                    openWindow(ctx+'/cloud/menu/tablelist/'+trigger_id+'?mark_child=1&'+pmStr,bak);

                }
            },openSqlSave:function(trigger_id,params,bak,display){
                $.post(ctx+"/cloud/form/handler/saveSqlSave/"+trigger_id,params,function(json){
                    if(json.result=="SUCCESS"){
                        tipsMsg("操作成功","SUCCESS");
                        if(bak){
                            bak();
                        }
                    }else{
                        tipsMsg(json.resultMsg,"FAIL");
                    }
                });
            },openTableTeam:function(trigger_id,params,bak,display){
                var pmStr = (btf.getParamsStr(params));
                if(display && display=="skipPage"){
                    window.open(ctx+'/cloud/menu/tableTeam/detail/'+trigger_id+'?'+pmStr,'_blank');
                }else{
                    openWindow(ctx+'/cloud/menu/tableTeam/detail/'+trigger_id+'?'+pmStr,bak);
                }
            },openPageLayout:function(trigger_id,params,bak,display){
                var pmStr = (btf.getParamsStr(params));
                if(display && display=="skipPage"){
                    window.open(ctx+'/cloud/menu/pageLayout/'+trigger_id+'?'+pmStr,'_blank');
                }else{
                    openWindow(ctx+'/cloud/menu/pageLayout/'+trigger_id+'?'+pmStr,bak);
                }
            },openAddress:function(url,params,bak,display){
                url =url.replace("{ctx}",ctx);
                var pmStr = (btf.getParamsStr(params));
                if(url.indexOf("?")==-1){url+='?';}
                url+=pmStr;
                if(display && display=="skipPage"){
                    window.open(url,'_blank');
                }else{
                    openWindow(url,bak);
                }
            }
        },
        form:{
        },getParamsStr:function(params){
            var str = "";
            if(params){
                for(var p in params){
                    if(p && params[p]){
                        str+="&"+p+"="+params[p];
                    }
                }
            }
            return str;
        }
    };

    function  dataList() {
        var dataStr = {
        }
        var mesg = ctx + "/cloud/form/handler/saveSqlSave/1073814223194165248";
        var tableId = "purchase_table_team";
        $("#"+tableId).jqGrid({
            url:mesg,  //url请求地址
            mtype:"post",  //请求方式
            datatype: "json",   //格式
            postData:dataStr,   //传递的参数
            //prmNames:dataStr,
            styleUI : 'Bootstrap',  //样式风格引用bootStrap
            colNames: ['列表主键Id','序号','过滤器名称','创建时间','更新时间','操作','sid'],   //表头
            colModel:[   //列  name和index要和接口字段对应
                {name:'id',index:'id'}
            ],
            viewrecords:true,  //定义是否要显示总记录
            forceFit:true,
            shrinkToFit:true,
            autowidth: true,  //自动适应宽度
//            pager: "#scriptListQdPage",   //分页显示
            loadComplete:function(){  //完成之后

            }
        })
    }
</script> -->

<script type="application/javascript">
    // function date_fun_dateDubbo(me){
    //     if(event.keyCode==13){
    //         $(me).blur();
    //         $(".layui-laydate").hide();
    //     }
    // }
    // function date_fun_dateBlur(me){
    //     /*me = $(me);
    //      var value=$.trim(me.val());
    //      var reg = /^[0-9]+$/;
    //      if(value.length==8 && reg.test(value)){
    //      me.val(value.substring(0,4)+"-"+value.substring(4,6)+"-"+value.substring(6,8))
    //      }*/
    // }
    // function date_fun_dateTimeBlur(me){
    //     var me = $(me);
    //     var value=$.trim(me.val());
    //     var vals=value.split(" ");
    //     var data="";
    //     var time="";
    //     if(vals.length==2){
    //         var dv=$.trim(vals[0]);
    //         var time = $.trim(vals[1]);
    //         var reg = /^[0-9]+$/;
    //         if(dv.length==8 && reg.test(dv)){
    //             data=value.substring(0,4)+"-"+value.substring(4,6)+"-"+value.substring(6,8);
    //         }
    //     }else if(vals.length==1){
    //         var dv=$.trim(vals[0]);
    //         var reg = /^[0-9]+$/;
    //         if(dv.length==8 && reg.test(dv)){
    //             data=value.substring(0,4)+"-"+value.substring(4,6)+"-"+value.substring(6,8);
    //         }
    //         time="00:00:00";
    //     }
    //     if(data && time){
    //         me.val(data+" "+time);
    //     }
    // }


    // //拖拽表单解析
    // var createHtml={
    //     search:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,isbt,validateObj){
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10"><div class="input-group">'+
    //                 '<input  '+disabled_str+' type="text" '+disabled_str+'  key="extend_element"  '+this.getValidateHtml(validateObj,isbt,fieldName)+' key_id="'+fieldKey+'Text" placeholder="'+(fieldName?fieldName:"")+'"  value="'+defaultVal+'"   class="form-control" name="'+fieldKey+'Text"/>'+
    //                 '<input type="hidden" key="extend_element"  key_id="'+fieldKey+'" value="'+defaultVal+'"  class="form-control" name="'+fieldKey+'"/>'+
    //                 '<div class="input-group-btn">'+
    //                 '<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">'+
    //                 '<span class="caret"></span>'+
    //                 ' </button>'+
    //                 ' <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>'+
    //                 ' </div>'+
    //                 '</div></div>'+
    //                 '</div>';
    //         return html;
    //     },
    //     searchMore:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,isbt){
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input type="text" class="form-control"  '+disabled_str+' key="extend_element"  isnull="'+isbt+'" '+this.getValidateHtml(null,isbt,fieldName)+' '+disabled_str+' key_name="'+fieldName+'" htmlType="SEARCH_MORE"  key_id="'+fieldKey+'" ' +
    //                 "valueKey='"+defaultVal+"'"+
    //                 '  name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'"/>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },searchSelect:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,isbt){
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input type="text" class="form-control"  '+disabled_str+'  key="extend_element"  isnull="'+isbt+'" '+this.getValidateHtml(null,isbt,fieldName)+' '+disabled_str+' key_name="'+fieldName+'" htmlType="SEARCH_SELECT"  key_id="'+fieldKey+'" ' +
    //                 "valueKey='"+defaultVal+"'"+
    //                 '  name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'"/>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },select:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,options,isbt){
    //         var selectHtml ='<select  '+disabled_str+'  isnull="'+isbt+'"   onkeydown="javascript:date_fun_dateDubbo(this);"   onchange="javascript:createHtml.validateSelect($(this));" key_name="'+fieldName+'"  class="form-control" key="extend_element"  key_id="'+fieldKey+'"  name="'+fieldKey+'">';
    //         if(options && options.length>0){
    //             for(var j=0;j<options.length;j++){
    //                 var text=options[j].valueName;
    //                 var value=options[j].format;
    //                 var selected ="";
    //                 if(defaultVal && ((defaultVal+"").indexOf(value)!=-1)){
    //                     selected="selected";
    //                 }
    //                 selectHtml+='<option '+selected+' value="'+value+'">'+text+'</option>';
    //             }
    //         }
    //         selectHtml+='</select>';
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+' has-feedback"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 selectHtml+
    //                 '<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="name" style="display: none"></i>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-ok" data-bv-icon-for="name" style="display: none;"></i>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },checkbox:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,options,isbt){
    //         var boxHtml ='';
    //         if(options && options.length>0){
    //             for(var j=0;j<options.length;j++){
    //                 var text=options[j].valueName;
    //                 var value=options[j].format;
    //                 var check="";
    //                 if(defaultVal && ((defaultVal+"").indexOf(value)!=-1)){
    //                     check="checked='checked'";
    //                 }
    //                 boxHtml+='<div class="checkbox inline"><label><input type="checkbox" key_name="'+fieldName+'"    onclick="javascript: createHtml.validateCheckAndRadio($(this).parents(&quot;.form-group&quot;));"   '+disabled_str+'  key="extend_element" name="'+fieldKey+'" '+check+' value="'+value+'"><span class="text">'+text+'</span></label></div>';
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'  has-feedback"  '+disabled_str+' key="extend_element" key_type="checkbox"  isnull="'+isbt+'" key_name="'+fieldKey+'">'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10"><div class="col-lg-12 component-border" >'+
    //                 boxHtml+
    //                 '</div>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="name" style="display: none"></i>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-ok" data-bv-icon-for="name" style="display: none;"></i>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },checkboxBlock:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,options,isbt){
    //         var boxHtml ='';
    //         if(options && options.length>0){
    //             for(var j=0;j<options.length;j++){
    //                 var text=options[j].valueName;
    //                 var value=options[j].format;
    //                 var check="";
    //                 if(defaultVal && ((defaultVal+"").indexOf(value)!=-1)){
    //                     check="checked='checked'";
    //                 }
    //                 boxHtml+='<div class="checkbox"><label><input type="checkbox" key_name="'+fieldName+'"   onclick="javascript: createHtml.validateCheckAndRadio($(this).parents(&quot;.form-group&quot;));"   '+disabled_str+'  key="extend_element" name="'+fieldKey+'" '+check+' value="'+value+'"><span class="text">'+text+'</span></label></div>';
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'  has-feedback"  '+disabled_str+' key="extend_element" key_type="checkbox"  isnull="'+isbt+'" key_name="'+fieldKey+'">'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10"><div class="col-lg-12 component-border" >'+
    //                 boxHtml+
    //                 '</div>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="name" style="display: none"></i>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-ok" data-bv-icon-for="name" style="display: none;"></i>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },redio:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,options,isbt){
    //         var boxHtml ='';
    //         if(options && options.length>0){
    //             for(var j=0;j<options.length;j++){
    //                 var text=options[j].valueName;
    //                 var value=options[j].format;
    //                 var check="";
    //                 if(defaultVal && ((defaultVal+"").indexOf(value)!=-1)){
    //                     check="checked='checked'";
    //                 }
    //                 boxHtml+='<div class="radio inline"><label><input type="radio" key_name="'+fieldName+'"  onclick="javascript: createHtml.validateCheckAndRadio($(this).parents(&quot;.form-group&quot;));"  '+disabled_str+'  key="extend_element" name="'+fieldKey+'" '+check+' value="'+value+'"><span class="text">'+text+'</span></label></div>';
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'  has-feedback"  '+disabled_str+'  key="extend_element" key_type="checkbox"  isnull="'+isbt+'" key_name="'+fieldKey+'">'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10"><div class="col-lg-12 component-border" >'+
    //                 boxHtml+
    //                 '</div>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="name" style="display: none"></i>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-ok" data-bv-icon-for="name" style="display: none;"></i>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+

    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },redioBlock:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,options,isbt){
    //         var boxHtml ='';
    //         if(options && options.length>0){
    //             for(var j=0;j<options.length;j++){
    //                 var text=options[j].valueName;
    //                 var value=options[j].format;
    //                 var check="";
    //                 if(defaultVal && ((defaultVal+"").indexOf(value)!=-1)){
    //                     check="checked='checked'";
    //                 }
    //                 boxHtml+='<div class="radio"><label><input type="radio" key_name="'+fieldName+'"  onclick="javascript: createHtml.validateCheckAndRadio($(this).parents(&quot;.form-group&quot;));"  '+disabled_str+'  key="extend_element" name="'+fieldKey+'" '+check+' value="'+value+'"><span class="text">'+text+'</span></label></div>';
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'  has-feedback"  '+disabled_str+'  key="extend_element" key_type="checkbox"  isnull="'+isbt+'" key_name="'+fieldKey+'">'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10"><div class="col-lg-12 component-border" >'+
    //                 boxHtml+
    //                 '</div>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-remove" data-bv-icon-for="name" style="display: none"></i>' +
    //                 '<i class="form-control-feedback glyphicon glyphicon-ok" data-bv-icon-for="name" style="display: none;"></i>'+
    //                 '<small class="help-block isnull_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'不能为空</small>'+

    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },textArea:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,validateObj,isbt){
    //         var length_text = "";
    //         if(validateObj){
    //             if(validateObj.maxlength || validateObj.minlength){
    //                 if(validateObj.maxlength && validateObj.minlength){
    //                     length_text= '<small class="help-block length_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'内容字数必须在'+validateObj.minlength+"~"+validateObj.maxlength+'字符之间</small>';
    //                 }else{
    //                     if(validateObj.maxlength){
    //                         length_text= '<small class="help-block length_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'内容字数不能大于'+validateObj.maxlength+'个字符</small>';
    //                     }else{
    //                         length_text= '<small class="help-block length_text" data-bv-validator="notEmpty" data-bv-for="name" data-bv-result="INVALID" style="display: none;">'+fieldName+'内容字数不能小于'+validateObj.minlength+'个字符</small>';
    //                     }
    //                 }
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<textarea class="form-control"   onkeydown="javascript:date_fun_dateDubbo(this);"  '+disabled_str+'   isnull="'+isbt+'"   ' +
    //                 this.getValidateHtml(validateObj,isbt,fieldName)+
    //                 ' key="extend_element" value="'+defaultVal+'" key_name="'+fieldName+'"  key_id="'+fieldKey+'" type="text" name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'">'+definedDecodeURIComponent(defaultVal)+'</textarea>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },date_input:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,validateObj,isbt,dbPM){
    //         defaultVal=getValueConversionDate(defaultVal,"yyyy-MM-dd");
    //         var minDate ="";
    //         var maxDate = "";
    //         if(validateObj){
    //             if(validateObj.minDate){
    //                 minDate=getParamsValue(validateObj.minDate,dbPM);
    //             }
    //             if(validateObj.maxDate){
    //                 maxDate=getParamsValue(validateObj.maxDate,dbPM);
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control date-picker" autocomplete="off"   minDate="'+minDate+'" maxDate="'+maxDate+'"    '+disabled_str+' onkeydown="javascript:date_fun_dateDubbo(this);"  onblur="javascript:date_fun_dateBlur(this);"   '+this.getValidateHtml(validateObj,isbt,fieldName)+' key_name="'+fieldName+'"   key="extend_element" value="'+defaultVal+'" key_id="'+fieldKey+'" type="text" name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'"' +
    //                 'db_type="date" format="yyyy-MM-dd">'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },datetime_input:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,validateObj,isbt,dbPM){
    //         defaultVal=getValueConversionDate(defaultVal,"yyyy-MM-dd HH:mm:ss");
    //         var minDate ="";
    //         var maxDate = "";
    //         if(validateObj){
    //             if(validateObj.minDate){
    //                 minDate=getParamsValue(validateObj.minDate,dbPM);
    //             }
    //             if(validateObj.maxDate){
    //                 maxDate=getParamsValue(validateObj.maxDate,dbPM);
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control date-picker" autocomplete="off"  minDate="'+minDate+'" maxDate="'+maxDate+'"  '+disabled_str+' '+this.getValidateHtml(validateObj,isbt,fieldName)+'  onkeydown="javascript:date_fun_dateDubbo(this);"  onblur="javascript:date_fun_dateTimeBlur(this);"   key="extend_element"  key_name="'+fieldName+'"  value="'+defaultVal+'" key_id="'+fieldKey+'" type="text" name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'"' +
    //                 'db_type="date" format="yyyy-MM-dd HH:mm:ss"'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },time_input:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,validateObj,isbt,dbPM){
    //         defaultVal=getValueConversionDate(defaultVal,"HH:mm:ss");
    //         var minDate ="";
    //         var maxDate = "";
    //         if(validateObj){
    //             if(validateObj.minDate){
    //                 minDate=getParamsValue(validateObj.minDate,dbPM);
    //             }F
    //             if(validateObj.maxDate){
    //                 maxDate=getParamsValue(validateObj.maxDate,dbPM);
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control date-picker"  autocomplete="off" minDate="'+minDate+'" maxDate="'+maxDate+'"   '+disabled_str+'  key="extend_element" key_name="'+fieldName+'" onkeydown="javascript:date_fun_dateDubbo(this);"  value="'+defaultVal+'" key_id="'+fieldKey+'" '+this.getValidateHtml(validateObj,isbt,fieldName)+' type="text" name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'"' +
    //                 'db_type="date" format="HH:mm:ss">'+
    //                 '<i class="fa fa-clendar" style="left: 122px"></i>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },date:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,validateObj,isbt,dbPM,date_format){
    //         defaultVal=getValueConversionDate(defaultVal,"HH:mm:ss");
    //         var minDate ="";
    //         var maxDate = "";
    //         if(validateObj){
    //             if(validateObj.minDate){
    //                 minDate=getParamsValue(validateObj.minDate,dbPM);
    //             }
    //             if(validateObj.maxDate){
    //                 maxDate=getParamsValue(validateObj.maxDate,dbPM);
    //             }
    //         }
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control date-picker" autocomplete="off"  minDate="'+minDate+'" maxDate="'+maxDate+'"   '+disabled_str+'  key="extend_element" key_name="'+fieldName+'" onkeydown="javascript:date_fun_dateDubbo(this);"  value="'+defaultVal+'" key_id="'+fieldKey+'" '+this.getValidateHtml(validateObj,isbt,fieldName)+' type="text" name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'"' +
    //                 'db_type="date" format="'+date_format+'">'+
    //                 '<i class="fa fa-calendar" style="left: 122px"></i>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },upfile:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str){
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control" upType="file" style="display:none;"  '+disabled_str+' key="extend_element"' +
    //                 "value='"+defaultVal+"' url_value='"+defaultVal+"'"+
    //                 'key_id="'+fieldName+'" class="file" type="file" multiple  data-show-upload="false" data-show-caption="true" key_name="'+fieldKey+'" name="file_data" placeholder="'+(fieldName?fieldName:"")+'"><div key="upload"></div>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },uppicture:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str){
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'">'+
    //                 '<div style="width:100%">'+
    //                 '<label style="line-height: 24px;">'+fieldName+'</label>'+
    //                 '<input class="form-control" upType="pic" style="display:none;"  '+disabled_str+' key="extend_element" value="'+defaultVal+'" url_value="'+defaultVal+'" key_id="'+fieldName+'" class="file" type="file" multiple  data-show-upload="false" data-show-caption="true" key_name="'+fieldKey+'" name="file_data" placeholder="'+(fieldName?fieldName:"")+'"><div key="upload"></div>'+
    //                 '</div></div>';

    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control" upType="pic" style="display:none;"  '+disabled_str+' key="extend_element" value="'+defaultVal+'" url_value="'+defaultVal+'" key_id="'+fieldName+'" class="file" type="file" multiple  data-show-upload="false" data-show-caption="true" key_name="'+fieldKey+'" name="file_data" placeholder="'+(fieldName?fieldName:"")+'"><div key="upload"></div>'+
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },input:function(fieldName,fieldKey,defaultVal,fieldWidth,disabled_str,validateObj,isbt){
    //         var html ='<div class="form-group component col-xs-'+fieldWidth+'"  '+disabled_str+'>'+
    //                 '<label class="col-lg-2 control-label">'+fieldName+("Y"==isbt?'<font class="redRequired" color="red">*</font>':'')+'</label>'+
    //                 '<div class="col-lg-10">'+
    //                 '<input class="form-control"  '+disabled_str+'  onkeydown="javascript:date_fun_dateDubbo(this);"    key="extend_element" key_name="'+fieldName+'" value="'+defaultVal+'" key_id="'+fieldName+'" '+this.getValidateHtml(validateObj,isbt,fieldName)+' name="'+fieldKey+'" placeholder="'+(fieldName?fieldName:"")+'">' +
    //                 '</div>'+
    //                 '</div>';
    //         return html;
    //     },getValidateHtml:function(validateObj,isbt,fieldName){
    //         var html = '';
    //         if("Y"==isbt){
    //             html+=' data-bv-notempty="true"';
    //             html+=' data-bv-notempty-message="'+fieldName+'不能为空"';
    //         }
    //         if(validateObj){
    //             if(validateObj && validateObj.validate){
    //                 if(validateObj.validate=="id_card"){
    //                     html+=' pattern="^[1-9]\\d{7}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}$|^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}([0-9]|X)$"  data-bv-regexp-message="'+fieldName+'格式不正确"';
    //                 }else if(validateObj.validate=="mobile"){
    //                     html+=' pattern="^(1\\d{10})$"  data-bv-regexp-message="'+fieldName+'格式不正确"';
    //                 }else if(validateObj.validate=="age"){
    //                     html+=' min="0"  data-bv-greaterthan-inclusive="false"  data-bv-greaterthan-message="'+fieldName+'不能小于0"';
    //                     html+=' max="120"  data-bv-lessthan-inclusive="false"   data-bv-lessthan-message="'+fieldName+'不能大于120"';
    //                 }else if(validateObj.validate=="email"){
    //                     html+=' type="email" data-bv-emailaddress-message="'+fieldName+'不是邮箱格式"';
    //                 }else if(validateObj.validate=="integer"){
    //                     html+=' pattern="^[0-9]+$"  data-bv-regexp-message="'+fieldName+'只能输入数字"';
    //                 }else if(validateObj.validate=="number"){
    //                     html+=' pattern="^((-?[0-9]+|0)\\.([0-9]+)$)|^(-?[0-9]+|0)$"  data-bv-regexp-message="'+fieldName+'只能输入数字和小数"';
    //                 }
    //             }
    //             if(validateObj.minlength || validateObj.maxlength ){
    //                 html+=' data-bv-stringlength="true"';
    //                 if(validateObj.minlength && validateObj.maxlength){
    //                     html+=' data-bv-stringlength-min="'+validateObj.minlength+'" data-bv-stringlength-max="'+validateObj.maxlength+'"  data-bv-stringlength-message="'+fieldName+'长度在'+validateObj.minlength+'~'+validateObj.maxlength+'个字符之间"';
    //                 }else{
    //                     if(validateObj.minlength){
    //                         html+=' data-bv-stringlength-min="'+validateObj.minlength+'" data-bv-stringlength-message="'+fieldName+'长度不能小于'+validateObj.minlength+'字符"';
    //                     }
    //                     if(validateObj.maxlength){
    //                         html+=' data-bv-stringlength-max="'+validateObj.maxlength+'" data-bv-stringlength-message="'+fieldName+'长度不能大于'+validateObj.maxlength+'字符"';
    //                     }
    //                 }
    //             }
    //         }
    //         return html;
    //     },
    //     definedValidate:function(formDiv){
    //         var divObj = $("#"+formDiv);
    //         var isyes = true;
    //         divObj.find("select[key=extend_element]").each(function(i,obj){
    //             obj = $(obj);
    //             if(!createHtml.validateSelect(obj)){
    //                 isyes=false;
    //             }
    //         });
    //         divObj.find("div[key=extend_element]").each(function(i,obj){
    //             obj = $(obj);
    //             if(!createHtml.validateCheckAndRadio(obj)){
    //                 isyes=false;
    //             }
    //         });
    //         divObj.find("textarea[key=extend_element]").each(function(i,obj){
    //             obj = $(obj);
    //             if(!createHtml.validateTextarea(obj)){
    //                 isyes=false;
    //             }
    //         });
    //         divObj.find("input[htmlType=SEARCH_SELECT]").each(function(i,obj){
    //             obj = $(obj);
    //             if(!createHtml.validateSelect(obj)){
    //                 isyes=false;
    //             }
    //         });
    //         return isyes;
    //     },validateSelect:function(obj){
    //         var thisYes =true;
    //         var parentObj = obj.parents(".form-group");
    //         var value = obj.val();
    //         if("Y"==obj.attr("isnull")){
    //             if(!value){
    //                 thisYes=false;
    //                 parentObj.removeClass("has-error");
    //                 parentObj.removeClass("has-success");
    //                 parentObj .addClass("has-error");
    //                 parentObj.find(".glyphicon-remove").show();
    //                 parentObj.find(".isnull_text").show();
    //                 parentObj.find(".glyphicon-ok").hide();
    //             }else{
    //                 parentObj.removeClass("has-error");
    //                 parentObj.removeClass("has-success");
    //                 parentObj.addClass("has-success");
    //                 parentObj.find(".glyphicon-remove").hide();
    //                 parentObj.find(".isnull_text").hide();
    //                 parentObj.find(".glyphicon-ok").show();
    //             }
    //         }
    //         return thisYes;
    //     },validateInput:function(obj){
    //         var thisYes =true;
    //         var parentObj = obj.parents(".form-group");
    //         var value = obj.val();
    //         if("Y"==obj.attr("isnull")){
    //             if(!value){
    //                 thisYes=false;
    //                 parentObj.removeClass("has-error");
    //                 parentObj.removeClass("has-success");
    //                 parentObj .addClass("has-error");
    //                 parentObj.find(".glyphicon-remove").show();
    //                 parentObj.find(".isnull_text").show();
    //                 parentObj.find(".glyphicon-ok").hide();
    //             }else{
    //                 parentObj.removeClass("has-error");
    //                 parentObj.removeClass("has-success");
    //                 parentObj.addClass("has-success");
    //                 parentObj.find(".glyphicon-remove").hide();
    //                 parentObj.find(".isnull_text").hide();
    //                 parentObj.find(".glyphicon-ok").show();
    //             }
    //         }
    //         return thisYes;
    //     },validateCheckAndRadio:function(obj){
    //         var thisYes =true;
    //         var keyType=obj.attr("key_type")
    //         if("checkbox"==keyType || "radio"==keyType){
    //             var isnull=obj.attr("isnull");
    //             if("Y"==isnull){
    //                 var parentObj=obj;
    //                 var yesSelect=false;
    //                 obj.find("input").each(function(i,obj){
    //                     if(obj.checked){
    //                         yesSelect=true;
    //                     }
    //                 });
    //                 if(yesSelect){
    //                     parentObj.removeClass("has-error");
    //                     parentObj.removeClass("has-success");
    //                     parentObj.addClass("has-success");
    //                     parentObj.find(".glyphicon-remove").hide();
    //                     parentObj.find(".isnull_text").hide();
    //                     parentObj.find(".glyphicon-ok").show();
    //                 }else{
    //                     thisYes=false;
    //                     parentObj.removeClass("has-error");
    //                     parentObj.removeClass("has-success");
    //                     parentObj .addClass("has-error");
    //                     parentObj.find(".glyphicon-remove").show();
    //                     parentObj.find(".isnull_text").show();
    //                     parentObj.find(".glyphicon-ok").hide();
    //                 }
    //             }
    //         }
    //         return thisYes;
    //     },validateTextarea:function(obj){
    //         var thisYes=true;
    //         var minlength=obj.attr("minlength");
    //         var maxlength=obj.attr("maxlength");
    //         var isnull = obj.attr("isnull");
    //         if(minlength || maxlength || isnull){
    //             var value = obj.val();
    //             var parentObj = obj.parents(".form-group");
    //             if("Y"==obj.attr("isnull")){
    //                 if(!value){
    //                     thisYes=false;
    //                     parentObj .removeClass("has-error");
    //                     parentObj .removeClass("has-success");
    //                     parentObj .addClass("has-error");
    //                     parentObj.find(".glyphicon-remove").show();
    //                     parentObj.find(".isnull_text").show();
    //                     parentObj.find(".length_text").hide();
    //                     parentObj.find(".glyphicon-ok").hide();
    //                 }
    //             }
    //             if(thisYes){
    //                 if(minlength && (value.length)<(minlength*1)){
    //                     thisYes=false;
    //                     parentObj .removeClass("has-error");
    //                     parentObj .removeClass("has-success");
    //                     parentObj .addClass("has-error");
    //                     parentObj.find(".glyphicon-remove").show();
    //                     parentObj.find(".isnull_text").hide();
    //                     parentObj.find(".length_text").show();
    //                     parentObj.find(".glyphicon-ok").hide();
    //                 }
    //             }
    //             if(thisYes){
    //                 if(maxlength && (value.length)>(maxlength*1)){
    //                     thisYes=false;
    //                     parentObj .removeClass("has-error");
    //                     parentObj .removeClass("has-success");
    //                     parentObj .addClass("has-error");
    //                     parentObj.find(".glyphicon-remove").show();
    //                     parentObj.find(".isnull_text").hide();
    //                     parentObj.find(".length_text").show();
    //                     parentObj.find(".glyphicon-ok").hide();
    //                 }
    //             }
    //             if(thisYes){
    //                 parentObj.removeClass("has-error");
    //                 parentObj .removeClass("has-success");
    //                 parentObj.addClass("has-success");
    //                 parentObj.find(".glyphicon-remove").hide();
    //                 parentObj.find(".isnull_text").hide();
    //                 parentObj.find(".length_text").hide();
    //                 parentObj.find(".glyphicon-ok").show();
    //             }
    //         }
    //         return thisYes;
    //     },
    //     jlChangClean:function(wordbook){
    //         var s
    //         if(wordbook && wordbook.setting && wordbook.setting.cascading &&  wordbook.setting.cascading.length>0){
    //             for(var i=0;i< wordbook.setting.cascading.length;i++){
    //                 var asobj = wordbook.setting.cascading[i];
    //                 if(asobj["form.name"] && asobj['value']){
    //                     $($("[key_name='"+asobj["form.name"]+"']")[0]).val("");
    //                 }
    //             }
    //         }
    //     },
    //     jlChangBak:function(wordbook,data){
    //         if(wordbook && wordbook.setting &&  wordbook.setting.cascading &&  wordbook.setting.cascading.length>0){
    //             for(var i=0;i< wordbook.setting.cascading.length;i++){
    //                 var asobj = wordbook.setting.cascading[i];
    //                 if(asobj["form.name"] && asobj['value'] && data[ asobj['value']]){
    //                     $($("[key_name='"+asobj["form.name"]+"']")[0]).val(data[ asobj['value']]);
    //                 }
    //             }
    //         }
    //     },init_obj:{
    //         initDate:function(q,isTwo){
    //             var format=$(q).attr("format");
    //             if(!format){
    //                 format="yyyy-MM-dd HH:mm:ss";
    //             }
    //             var type="datetime";
    //             if(format=="yyyy-MM-dd"){
    //                 type="date";
    //             }else if(format=="yyyy-MM"){
    //                 type="month";
    //             }else if(format=="HH:mm:ss"){
    //                 type="time";
    //             }
    //             var min = $(q).attr("minDate");
    //             var max = $(q).attr("maxDate");
    //             var setting={
    //                 elem:q,
    //                 format:format,
    //                 type:type,
    //                 done: function(value, date, endDate){
    //                     $(q).val(value);
    //                     //$(q).focus();
    //                     setTimeout(function(){$(q).blur();},100);
    //                 }
    //             };
    //             if(min){	//最小日期
    //                 if(min=="currTime"){	//当前时间
    //                     min = dateFormat(new Date()+"");
    //                 }
    //                 setting['min']=min;
    //             }
    //             if(max){	//最大日期
    //                 if(max=="currTime"){	//当前时间
    //                     max = dateFormat(new Date()+"");
    //                 }
    //                 setting['max']=max;
    //             }

    //             laydate.render(setting);
    //         }
    //     }
    // };

    // function getValueConversionDate(value,format){
    //     if(value && /^[0-9]+$/.test(value)){
    //         try{
    //             var date=new Date(value);
    //             return date.format(format);
    //         }catch(e){}
    //     }
    //     return value;
    // }
    // function  getParamsValue(keys,dbPM){
    //     if(keys && keys.indexOf(".")!=-1){
    //         var key = keys.split(".")[0];
    //         var key2 =keys.split(".")[1];
    //         if(dbPM[key] && dbPM[key][key2]){
    //             return dbPM[key][key2];
    //         }
    //     }
    //     return keys;
    // }

    // function initUPPic(fileObj,img,selectFileBakFun,successBakFun,buttonText){
    //     var displayTxt="";
    //     if(selectFileBakFun || successBakFun){
    //         displayTxt="display:none;";
    //     }
    //     var initImg = getInitImg(img);
    //     var div =$(fileObj.parent().find("div[key=upload]")[0]);
    //     var createHtml='<div class="picture-wrap"><div class="col click_button"><input id="fileImage" style="display: none;" type="file" size="30" name="fileselect[]"  multiple><div class="img-box btn-img-box click_picture"><a href="javascript:void(0);" class="btn btn-warning  btn-circle btn-lg"><i class="glyphicon glyphicon-camera"></i></a></div></div></div>';
    //     div.zyUpload({
    //         url              :    '/crmweb/cloud/upload/hospital/hospital', //上传的地址
    //         initUrl:initImg,
    //         multiple         :   true,                    // 是否可以多个文件上传
    //         suffix:"jpg,png,gif,jpeg",
    //         createHtml:createHtml,
    //         clickClass:"click_picture",
    //         /* 外部获得的回调接口 */
    //         onSelect: function(files, allFiles,boj,ZYFILE){
    //             var i = 0;
    //             var html = '', i = 0;
    //             // 组织预览html
    //             var funDealtPreviewHtml = function(fList) {
    //                 for(var z=0;z<fList.length;z++){
    //                     var file = fList[z];
    //                     var reader = new FileReader();
    //                     reader.onload = function(e) {
    //                         html+=  '<div class="col" style="'+displayTxt+'" key="'+file.index+'">'+
    //                         '<div class="img-box">'+
    //                         '<div class="shadow-bg">'+
    //                         '<i class="fa fa-spinner fa-spin"></i>'+
    //                         '</div>'+
    //                         '<img src="'+e.target.result+'" alt=""/><em class="removePic" index="'+file.index+'" mark="1" title="删除"><i class="glyphicon glyphicon-remove"></i></em><input type="hidden" key="url">' +
    //                         '</div>' +
    //                         '</div>';
    //                         i++;
    //                         $(boj).find(".click_button").before(html);
    //                         $(boj).find(".removePic").bind("click",function(){
    //                             var obj = $(this);
    //                             if(obj.attr("mark")=="1"){
    //                                 var index = $(this).attr("index");
    //                                 $(this).parent().parent().remove();
    //                                 ZYFILE.funDeleteFile(index,false);
    //                                 obj.attr("mark","0");
    //                             }
    //                         });
    //                         if(selectFileBakFun){
    //                             selectFileBakFun(file,e.target.result,fileObj);
    //                         }
    //                     }
    //                     reader.readAsDataURL(file);
    //                 }
    //             };
    //             function funAppendPreviewHtml(){
    //                 for(var z=0;z<files.length;z++){
    //                     try{
    //                         ZYFILE.funUploadFile(files[z]);
    //                     }catch(e){console.log("error:\t"+e);}
    //                 }
    //                 funDealtPreviewHtml(files);
    //             }
    //             funAppendPreviewHtml();
    //         },
    //         onDelete: function(file, surplusFiles){                     // 删除一个文件的回调方法
    //             console.info("当前删除了此文件：");
    //             console.info(file);
    //             console.info("当前剩余的文件：");
    //             console.info(surplusFiles);
    //         },
    //         initImg:function(files,boj){
    //             if(!files || files.length==0)
    //                 return;
    //             var html = "";
    //             for(var i=0;i<files.length;i++){
    //                 var file = files[i];
    //                 html+=  '<div class="col" key="'+file.index+'">'+
    //                 '<div class="img-box">'+
    //                 '<div class="shadow-bg" style="display: none">'+
    //                 '<i class="fa fa-spinner fa-spin"></i>'+
    //                 '</div>'+
    //                 '<img src="'+file.url+'" alt=""/><em onclick="javascript:$(this).parent().parent().remove();"><i class="glyphicon glyphicon-trash"></i></em><input type="hidden" key="url" value="'+file.url+'">' +
    //                 '</div>' +
    //                 '</div>';
    //             }
    //             $(boj).find(".click_button").before(html);
    //         },
    //         onSuccess: function(file, response,obj){                    // 文件上传成功的回调方法
    //             var obj = $(obj);
    //             var index=file.index;
    //             if(response){
    //                 response=eval('('+response+')');
    //             }
    //             if(response.status==true){
    //                 var divObj=$(obj.find("div[key='"+index+"']")[0]);
    //                 divObj.find("img").attr("src",response.url);
    //                 divObj.find("input").val(response.url);
    //                 divObj.find(".shadow-bg").hide();
    //                 if(successBakFun){
    //                     successBakFun(file,response,fileObj);
    //                 }
    //             }else{
    //                 alert("上传失败");
    //             }
    //         },
    //         onFailure: function(file){                    // 文件上传失败的回调方法
    //             console.info("此文件上传失败：");
    //             console.info(file);
    //         },
    //         onComplete: function(responseInfo){           // 上传完成的回调方法
    //             console.info("文件上传完成");
    //             console.info(responseInfo);
    //         }
    //     });

    //     function getInitImg(img){
    //         var initImg=[];
    //         if(img){
    //             img = $.trim(img);
    //             if(img.length>0){
    //                 var img_array = img.split(",");
    //                 for(var i=0;i<img_array.length;i++){
    //                     var url = $.trim(img_array[i]);
    //                     if(url){
    //                         initImg.push({index:"init_"+i,url:url});
    //                     }
    //                 }
    //             }
    //         }
    //         return initImg;
    //     }
    // }
    // /**
    //  * 文件上传  新增回调方法
    //  * selectFileBakFun 选择文件后回调  入参 fiel={id,name,size文件信息}
    //  * successBakFun 上传成功后回调   入参  file ,response={url：上传后的文件地址}
    //  * **/
    // function initUPFile(fileObj,fileStr,selectFileBakFun,successBakFun,buttonText){
    //     var files = getInitFile(fileStr);
    //     var div =$(fileObj.parent().find("div[key=upload]")[0]);
    //     var btxt = "添加附件";
    //     if(buttonText){
    //         btxt=buttonText;
    //     }
    //     var createHtml='<div class="container-fluid fujian-wrap">'+
    //             '<input  style="display: none;" type="file" size="30" name="fileselect[]"  multiple>'+
    //             '<span class="icon-right add-fj click_up_file">'+
    //             '<a class="btn btn-link" href="javascript:void(0);"><i class="glyphicon glyphicon-paperclip"></i>'+btxt+'</a>'+
    //             '</span>'+
    //             '</div>'
    //     div.zyUpload({
    //         url              :    '/crmweb/cloud/upload/hospital/uploadFile', //上传的地址
    //         initUrl:files,
    //         clickClass:"click_up_file",
    //         multiple         :   true,                    // 是否可以多个文件上传
    //         createHtml:createHtml,
    //         /* 外部获得的回调接口 */
    //         onSelect: function(files, allFiles,boj,ZYFILE){
    //             var html = '';
    //             var displayTxt="";
    //             if(selectFileBakFun || successBakFun){
    //                 displayTxt="display:none;";
    //             }
    //             if(files && files.length>0){
    //                 for(var i=0;i<files.length;i++){
    //                     var file = files[i];
    //                     var index = file.index;
    //                     var name = file.name;
    //                     var size = getSize(file.size);
    //                     html+=  '<span class="icon-right" style="'+displayTxt+'" key="'+index+'">'+
    //                     '<a class="btn btn-link" href="javascript:void(0);"><i class="glyphicon glyphicon-paperclip"></i> '+name+'('+size+')</a>' +
    //                     '<i class="fa fa-spinner fa-spin"></i>'+
    //                     '<i class="fa fa-close removeFile" mark="1" index="'+index+'" onclick="javascript:$(this).parent().remove();">删除</i>'+
    //                     '<input type="hidden" name="'+name+'" size="'+size+'" key="url">'+
    //                     '</span>'

    //                 }
    //             }
    //             $(boj).find(".fujian-wrap").append(html);
    //             $(boj).find(".removeFile").each(function(i,obj){
    //                 obj = $(obj);
    //                 if(obj.attr("mark")=="1"){
    //                     obj.bind("click",function(){
    //                         var index = $(this).attr("index");
    //                         $(this).parent().remove();
    //                         ZYFILE.funDeleteFile(index,false);
    //                     }) ;
    //                     obj.attr("mark","0");
    //                 }
    //             });
    //             for(var i=0;i<files.length;i++) {
    //                 var file = files[i];
    //                 if(selectFileBakFun){
    //                     selectFileBakFun(file,fileObj);
    //                 }
    //                 try{
    //                     ZYFILE.funUploadFile(file);
    //                 }catch(e){console.log("error:\t"+e);}
    //             }
    //         },
    //         onDelete: function(file, surplusFiles){                     // 删除一个文件的回调方法
    //             console.info("当前删除了此文件：");
    //             console.info(file);
    //             console.info("当前剩余的文件：");
    //             console.info(surplusFiles);
    //         },
    //         initImg:function(files,boj){
    //             if(files && files.length>0){
    //                 var html ="";
    //                 for(var i=0;i<files.length;i++){
    //                     var file = files[i];
    //                     var name = file.name;
    //                     var size = file.size;
    //                     var url = file.url;
    //                     var index="init_"+i;;
    //                     html+=  '<span class="icon-right" key="'+index+'">'+
    //                     '<a class="btn btn-link" href="javascript:void(0);"><i class="glyphicon glyphicon-paperclip"></i> '+name+'('+size+')</a>' +
    //                     '<i class="fa fa-spinner fa-spin" style="display:none;"></i>'+
    //                     '<i class="fa fa-close removeFile" mark="1" index="'+index+'" onclick="javascript:$(this).parent().remove();">删除</i>'+
    //                     '<input type="hidden" value="'+url+'"  name="'+name+'" size="'+size+'" key="url">'+
    //                     '</span>'
    //                 }
    //                 $(boj).find(".fujian-wrap").append(html);
    //             }
    //         },
    //         onSuccess: function(file, response,obj){                    // 文件上传成功的回调方法
    //             var obj = $(obj);
    //             var index=file.index;
    //             if(response){
    //                 response=eval('('+response+')');
    //             }
    //             if(response.status==true){
    //                 if(successBakFun){
    //                     successBakFun(file,response,fileObj);
    //                 }else{
    //                     var divObj=$(obj.find("span[key='"+index+"']")[0]);
    //                     divObj.find(".fa-spin").hide();
    //                     $(divObj.find("input")[0]).val(response.url);
    //                 }
    //             }else{
    //                 alert("上传失败");
    //             }
    //         },
    //         onFailure: function(file){                    // 文件上传失败的回调方法
    //             console.info("此文件上传失败：");
    //             console.info(file);
    //         },
    //         onComplete: function(responseInfo){           // 上传完成的回调方法
    //             console.info("文件上传完成");
    //             console.info(responseInfo);
    //         }
    //     });

    //     function getInitFile(fileStr){
    //         if(fileStr){
    //             var files = eval('('+fileStr+')');
    //             return files;
    //         }
    //     }
    // }

    // function getSize(size){
    //     if(size && size>0){
    //         if (size > 1024 * 1024) {
    //             size = (Math.round(size * 100 / (1024 * 1024)) / 100).toString() + 'MB';
    //         } else {
    //             size = (Math.round(size * 100 / 1024) / 100).toString() + 'KB';
    //         }
    //     }
    //     return size;
    // }

</script>

<script src="../../../../src/scripts/js/plug-in/echarts-2.2.7/echarts.js"></script>
<script type="text/javascript" src="../../../../src/scripts/js/cloud/menu/home_page2.js"></script>
<script type="application/javascript">
    // require.config({
    //     paths: {
    //         // echarts: '/crmweb/lib/js/echarts-2.2.7'
    //         echarts: '../../../../src/scripts/js/plug-in/echarts-2.2.7'
    //     }
    // });
    // var isReload =false;
    // var echart;
    // function chartInit(divId,config){
    //     this.config = config;
    //     this.titleObj=config.name;
    //     this.divId = divId;
    //     this.dataList ;
    //     this.fieldList=[];
    //     this.tableFilterObj={};
    //     this.parentDivObj = $("#"+divId).parent();
    //     this.getOption=function(dataList,config){
    //         if(config.comType=="LINE" || config.comType=="BAR"){
    //             if(config.comType=="LINE"){
    //                 return this.getLinAndBarOption(dataList,config,"line");
    //             }else{
    //                 return this.getLinAndBarOption(dataList,config,"bar");
    //             }
    //         }else{
    //             return this.getPieOption(dataList,config);
    //         }
    //     };
    //     this.initEvent=function(){
    //         var me = this;
    //         var groupField=me.config.groupField;
    //         var groupFieldObj = this.getFieldByFieldKey(groupField);
    //         if(groupFieldObj.fieldType=="DATE" ||groupFieldObj.fieldType=="DATETIME"){
    //             me.parentDivObj.find(".chart-nav-list").html(
    //                     '<li key="DAY">按天查看</li>'+
    //                     '<li key="MONTH">按月查看</li>'+
    //                     '<li key="YEAR">按年查看</li>'
    //             );
    //             if(me.config.groupMode){
    //                 me.parentDivObj.find(".chart-nav-list").find("li[key="+me.config.groupMode+"]").addClass("selected");
    //             }
    //             me.parentDivObj.find(".chart-nav-list li").bind("click",function(){
    //                 me.parentDivObj.find(".chart-nav-list li").removeClass('selected');
    //                 $(this).addClass("selected");
    //                 me.initChat();
    //             });
    //         }
    //         me.parentDivObj.find("span[key=filter_btn]").bind("click",function(){
    //             $(me.parentDivObj.find("div[name=addConditionModal]")[0]).modal('show');
    //         });
    //         me.parentDivObj.find("span[key=setting_btn]").bind("click",function(){
    //             var url = ctx+'/new/menu/setting.jsp?tableId='+me.config.dataSource+'&menuId='+me.config.pageId+"&type=HOMEPAGE";
    //             me.config.openWindow(url,function(){
    //                 me.init();
    //             });
    //         });
    //     }
    //     this.getFieldByFieldKey=function (fieldKey){
    //         var me = this;
    //         if(me.fieldList && me.fieldList.length>0){
    //             for(var i=0;i<me.fieldList.length;i++){
    //                 var fobj = me.fieldList[i];
    //                 if(fobj.columnName == fieldKey){
    //                     return fobj;
    //                 }
    //             }
    //         }
    //     };
    //     this.filterInit=function(fieldList){
    //         var me = this;
    //         var divObj=this.parentDivObj.find(".filterDiv");
    //         this.parentDivObj.find(".filterDiv").html("");
    //         $.post(ctx+"/cloud/behind/stableListConfig/getFieldType",function(json){
    //             if(json.result=="Success" || json.result=="SUCCESS"){
    //                 var fieldTypeList=json.list;
    //                 me.tableFilterObj=new tableFilter(divObj,"",fieldList,fieldTypeList,"");
    //                 me.tableFilterObj.init();
    //                 divObj.find("div[name=addConditionModal]").find("span[key=ft]").remove();
    //                 divObj.find("div[name=addConditionModal]").find("textarea[name=sqlExpression]").parent().remove();
    //                 divObj.find("div[name=addConditionModal]").find("button[key=addConditionModal_save_btn]").remove();
    //                 divObj.find("div[name=addConditionModal]").find("div[key=flname_div]").remove();
    //                 divObj.find("div[name=addConditionModal]").find("h5[name=addConditionModalLabel]").html('<span class="middle">条件过滤</span>');
    //                 divObj.find("div[name=addConditionModal]").find("span[key=addFieldSearch]").find(".middle").html("添加条件");
    //                 divObj.find("div[name=addConditionModal]").find(".modal-footer").prepend('<button type="button" key="filter_query_btn" class="btn btn-primary">查询</button>');
    //                 divObj.find("div[name=addConditionModal]").find("button[key=filter_query_btn]").bind("click",function(){
    //                     me.initChat();
    //                     divObj.find("div[name=addConditionModal]").find(".modal-footer").find(".btn-default").click();
    //                 });
    //             }else{
    //                 tipsMsg(json.resultMsg,"FAIL");
    //             }
    //         });
    //     }
    //     this.getFilterDbConfig=function(){
    //         var me = this;
    //         var divObj=me.parentDivObj.find(".filterDiv");
    //         var trList =divObj.find("div[name=addConditionModal]").find("[name=addConditionTable] tr");
    //         if(me.tableFilterObj && me.tableFilterObj.getDbConfig){
    //             var conObj=me.tableFilterObj.getDbConfig(trList);
    //             if(conObj){
    //                 return conObj;
    //             }
    //         }
    //     }
    //     this.getPieOption=function(dataList,config){
    //         var xData = [];
    //         var yData=[];
    //         for(var i=0;i<dataList.length;i++){
    //             var db = dataList[i];
    //             var groupFile = "空";
    //             if(db['groupfield']){
    //                 groupFile = db['groupfield'];
    //             }
    //             xData.push(groupFile);
    //             yData.push({value:db['countfiled'],name:groupFile});
    //         }
    //         this.titleObj.x="center";
    //         return {
    //             title :{},
    //             backgroundColor:"#fbfbfb",
    //             tooltip : {
    //                 trigger: 'item',
    //                 formatter: "{a} <br/>{b} : {c} ({d}%)"
    //             },
    //             legend: {
    //                 orient : 'vertical',
    //                 x : 'left',
    //                 data:xData
    //             },
    //             calculable : true,
    //             series : [
    //                 {
    //                     name:config.name,
    //                     type:'pie',
    //                     radius : '60%',
    //                     center: ['50%', '60%'],
    //                     data:yData
    //                 }
    //             ]
    //         };
    //     };
    //     this.getLinAndBarOption=function(dataList,config,type){
    //         var objList=[];
    //         var legend=[];
    //         var gfDB={};
    //         var childGroupList;
    //         for(var i=0;i<dataList.length;i++){
    //             var db = dataList[i];
    //             if(db['groupfield']){
    //                 var fdb = gfDB[db['groupfield']];
    //                 if(!fdb){
    //                     fdb={};
    //                 }
    //                 if(config.childGroupField){
    //                     if(!childGroupList){
    //                         childGroupList={};
    //                     }
    //                     var childGroupField="空";
    //                     if(db['childgroupfield']){
    //                         childGroupField=db['childgroupfield'];
    //                     }
    //                     fdb[childGroupField]={"value":db['countfiled']};
    //                     if(!childGroupList[childGroupField]){
    //                         childGroupList[childGroupField]=1;
    //                     }
    //                 }else{
    //                     fdb['value']=db['countfiled'];
    //                 }
    //                 gfDB[db['groupfield']]=fdb;
    //             }
    //         }
    //         var series=[];
    //         var xData=[];
    //         if(childGroupList){
    //             for(var i in childGroupList){
    //                 legend.push(i);
    //                 var data=[];
    //                 for(var z in gfDB){
    //                     var zobj = gfDB[z];
    //                     if(zobj[i] && zobj[i].value){
    //                         data.push(zobj[i].value);
    //                     }else{
    //                         data.push(0);
    //                     }
    //                 }
    //                 series.push({name:i,type:type,data:data});
    //             }
    //             var data=[];
    //             for(var i in gfDB){
    //                 xData.push(i);
    //                 var zobj = gfDB[i];
    //                 var value = 0;
    //                 for(var z in zobj){
    //                     if(zobj[z] && zobj[z].value){
    //                         value+=(zobj[z].value*1);
    //                     }
    //                 }
    //                 data.push(value);
    //             }
    //             series.unshift({name:"总"+config.countFiled_desc,type:type,data:data});
    //             legend.unshift("总"+config.countFiled_desc);
    //         }else{
    //             var data=[];
    //             for(var i in gfDB) {
    //                 xData.push(i);
    //                 var zobj = gfDB[i];
    //                 data.push(zobj.value);
    //             }
    //             series.unshift({name:config.countFiled_desc,type:type,data:data});
    //             legend.push(config.countFiled_desc);
    //         }
    //         this.titleObj.x="left";
    //         return {
    //             backgroundColor:"#fbfbfb",
    //             title :{},
    //             tooltip : {trigger: 'axis'},
    //             smooth:true,
    //             legend: {
    //                 data:legend,
    //                 x: 'center'
    //             },
    //             calculable : true,
    //             xAxis : [
    //                 {
    //                     type : 'category',
    //                     data :xData
    //                 }
    //             ],
    //             yAxis : [
    //                 {type : 'value'}
    //             ],
    //             series : series
    //         };
    //     };
    //     this.refursh=function(){
    //         this.init();
    //     }
    //     this.init=function(){
    //         var me= this;
    //         $.post(ctx+"/cloud/userUiConfig/postGet",{module:me.config.dataSource,menuId:me.config.pageId,type:"HOMEPAGE"},function(json){
    //             if(json.result=="Success" || json.result=="SUCCESS"){
    //                 var jsonMap=json.map;
    //                 me.fieldList = jsonMap.fieldList;
    //                 me.filterInit(me.fieldList);
    //                 me.initEvent();
    //                 me.initChat();
    //             }else{
    //                 tipsMsg(json.resultMsg,"FAIL");
    //             }
    //         });
    //     }
    //     this.initChat=function(){
    //         var me = this;
    //         var dataSource=me.config.dataSource;
    //         var groupField=me.config.groupField;
    //         var childGroupField=me.config.childGroupField;
    //         var countFiled = me.config.countFiled;
    //         var groupOrder=me.config.group_order;
    //         var groupMode = me.config.groupMode;
    //         if(me.parentDivObj.find(".chart-nav-list").find(".selected").length>0){
    //             groupMode=$(me.parentDivObj.find(".chart-nav-list").find(".selected")[0]).attr("key");
    //         }
    //         var conObj=[];
    //         if(me.config.filterCondition && me.config.filterCondition){
    //             var filterConditionObj = JSON.parse(me.config.filterCondition);
    //             if(filterConditionObj && filterConditionObj.conObj && filterConditionObj.conObj.length>0){
    //                 conObj =  filterConditionObj.conObj;
    //             }
    //         }
    //         var filterDbCon=me.getFilterDbConfig();
    //         if(filterDbCon && filterDbCon.length>0){
    //             for(var i=0;i<filterDbCon.length;i++){
    //                 var cobj = filterDbCon[i];
    //                 conObj.push(cobj);
    //             }
    //         }
    //         var groupCondition={groupField:groupField,childGroupField:childGroupField,countFiled:countFiled,groupMode:groupMode,groupOrder:groupOrder};
    //         $.post(ctx+"/cloud/table/list/reader/list",{tableId:dataSource,rows:100,groupCondition:JSON.stringify(groupCondition),conObj:JSON.stringify(conObj)},function(json){
    //             me.dataList=json.rows;
    //             var option = me.getOption(json.rows,config);
    //             if(me.config.comType=="PIE"){
    //                 if(isReload){
    //                     var myChart = echart.init(document.getElementById(me.divId),'macarons');
    //                     window.onresize = myChart.resize;
    //                     myChart.setOption(option);
    //                     window.onresize = myChart.resize;
    //                     return;
    //                 }
    //                 require(
    //                         [
    //                             'echarts',
    //                             'echarts/chart/line',   // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
    //                             'echarts/chart/bar',
    //                             'echarts/chart/pie'
    //                         ],
    //                         function (ec) {
    //                             isReload=true;
    //                             echart=ec;
    //                             var myChart = echart.init(document.getElementById(me.divId),'macarons');
    //                             window.onresize = myChart.resize;
    //                             myChart.setOption(option);
    //                             window.onresize = myChart.resize;
    //                         }
    //                 );
    //             }else{
    //                 if(isReload){
    //                     var myChart = echart.init(document.getElementById(me.divId),'macarons');
    //                     window.onresize = myChart.resize;
    //                     myChart.setOption(option);
    //                     window.onresize = myChart.resize;
    //                     return;
    //                 }
    //                 require(
    //                         [
    //                             'echarts',
    //                             'echarts/chart/line',   // 按需加载所需图表，如需动态类型切换功能，别忘了同时加载相应图表
    //                             'echarts/chart/bar',
    //                             'echarts/chart/pie'
    //                         ],
    //                         function (ec) {
    //                             isReload=true;
    //                             echart=ec;
    //                             var myChart = echart.init(document.getElementById(me.divId),'macarons');
    //                             window.onresize = myChart.resize;
    //                             myChart.setOption(option);
    //                             window.onresize = myChart.resize;
    //                         }
    //                 );
    //             }
    //         });
    //     }
    // };
    // function showTable(tableList,valueMap,divId,chartId){
    //     var tableIdList="";
    //     if(tableList && tableList.length>0){
    //         var tableContent =$("#"+divId);
    //         tableContent.html("");
    //         for(var i=0;i<tableList.length;i++){
    //             var table = tableList[i];
    //             var tableId = table.id;
    //             var dbList=valueMap[tableId];
    //             var tableName =table.name;
    //             var fieldList=table.fieldList;
    //             if(tableIdList.indexOf(","+tableId+",")==-1){
    //                 tableIdList+=","+tableId+",";
    //             }else{
    //                 continue;
    //             }
    //             if(fieldList && fieldList.length>0){
    //                 var heandHtml = "";
    //                 var bodyTrHtml = "";
    //                 for(var j=0;j<fieldList.length;j++){
    //                     heandHtml+="<th>"+fieldList[j].fieldName+"</th>";
    //                 }
    //                 for(var j=0;j<dbList.length;j++){
    //                     bodyTrHtml+="<tr>";
    //                     var rowDB=dbList[j];
    //                     for(var z=0;z<fieldList.length;z++){
    //                         var value=rowDB[fieldList[z].fieldKey];
    //                         if(!value){
    //                             value="";
    //                         }
    //                         bodyTrHtml+="<td>"+value+"</td>";
    //                     }
    //                     bodyTrHtml+="</tr>";
    //                 }
    //                 var tableHtml =
    //                         "<div class='col-xs-12 col-md-12'>" +
    //                         "<div class='well with-header  with-footer'>" +
    //                         "<div class='header bg-blue'>"+tableName+
    //                         '<a href="javascript:;" style="float: right;"  onclick="javascript:cleanCache(this);" url="'+ctx+'/cloud/sys/chart/init/'+chartId+'?cleanCatch=cleanCatch"><i class="fa fa-refresh"></i></a>'
    //                         +"</div>" +
    //                         "<table class='table table-hover'>" +
    //                         "<thead class='bordered-darkorange'>" +
    //                         "<tr>"+heandHtml+"</tr>" +
    //                         "</thead>" +
    //                         "<tbody>" +
    //                         bodyTrHtml+
    //                         "</tbody>" +
    //                         "</table>" +
    //                         "</div>" +
    //                         "</div>";
    //                 tableContent.append($(tableHtml));
    //             }
    //         }
    //     }
    // }

</script>


<script type="application/javascript">
//     function tableList(divObj,config){
//         var me = this;
//         me.tableId = config.id;
//         me.params = config.params;
//         me.divObj = divObj;
//         me.config=config;
//         me.fastSearchxx;
//         me.tableFilterxx;
//         me.buttonConfigObj={};
//         me.editDelButtonList=[];
//         me.divWidth=divObj.width();
//         me.divHeight =(me.config.h*1*150);
//         me.gridObj={};
//         me.fieldList=[];
//         me.buttonList=[];
//         me.conditionList={};
//         me.current_select_data={};
//         me.current_db_rows=[];
//         me.fieldTypeList=[];
//         me.reloadInit=function(){
//             me.init();
//         };
//         me.initEvent=function(){
//             me.divObj.find(".table_search_btn").bind("click",function(){
//                 me.search();
//             });
//             me.divObj.find(".searchText").bind("keydown",function(event){
//                 if(event.keyCode==13){
//                     me.search();
//                 }
//             });
//             me.divObj.find(".set-table-btn").bind("click",function(event){
//                 var url = ctx+'/new/menu/setting.jsp?tableId='+me.tableId+'&menuId='+me.config.menuId;
//                 me.config.openWindow(url,me.reloadInit);
//             });
//             me.divObj.find("button[bt_type=ADD]").bind("click",function(){//新增类按钮
//                 var obj = this;
//                 me.clickButton(obj);
//             });
//             me.divObj.find("span[name=quickQueryBtn]").bind("click",function(){
//                 $(me.divObj.find("div[name=queryModal]")[0]).modal('show');
//             });
//             me.divObj.find("li[key=openAddClassModalBtn]").bind("click",function(){
//                 $(me.divObj.find("div[name=addClassModal]")[0]).modal('show');
//             });


//         };
//         me.loadingEvent=function (){
//             me.divObj.find("span[bt_mark=editOrDel],a[bt_type=LINK]").bind("click",function(){
//                 var obj = this;
//                 me.clickButton(obj);
//             });
//         };
//         me.init=function(){
//             me.initHtml();
//             var data={module:me.tableId,menuId:me.config.menuId};
//             $.post(ctx+"/cloud/userUiConfig/postGet",data,function(json){
//                 if(json.result=="Success" || json.result=="SUCCESS"){
//                     var jsonMap=json.map;
//                     //TODO
//                     //
//                     me.fastSearchxx=new fastSearch($(me.divObj.find(".search_head_div")[0]),me,jsonMap.fieldList);
//                     me.fastSearchxx.init();
//                     me.initEvent();
//                     $.post(ctx+"/cloud/behind/stableListConfig/getFieldType",function(json){
//                         if(json.result=="Success" || json.result=="SUCCESS"){
//                             me.fieldTypeList=json.list;
//                             me.tableFilterxx=new tableFilter($(me.divObj.find(".search_head_div")[0]),me,jsonMap.fieldList,me.fieldTypeList,me.fastSearchxx);
//                             me.tableFilterxx.init();
//                             me.initConditionList(me.tableFilterxx,jsonMap);
//                         }else{
//                             tipsMsg(json.resultMsg,"FAIL");
//                         }
//                     });
//                 }else{
//                     tipsMsg(json.resultMsg,"FAIL");
//                 }
//             });
//             function initTable(jsonMap){
//                 var columns = createColList(jsonMap);
//                 me.gridObj=$("#"+me.config.markId).jqGrid({
//                     url: ctx+'/cloud/table/list/reader/list',
//                     mtype: "POST",
//                     styleUI : 'Bootstrap',
//                     datatype: "json",
//                     scrollrows: true,//行可见,
//                     postData:{tableId:me.tableId},
//                     paramsFun:function(){
//                         return me.getSearchParams();//搜索参数
//                     },
//                     gridComplete:function(a,b,c){},
//                     colModel: columns,
//                     viewrecords: true,
//                     height: (me.divHeight-86-38),
//                     rowNum: (tableSetting && tableSetting.pageSize)? tableSetting.pageSize : 20,
//                     pager: "#"+(me.config.markId)+"_gridPager",
//                     rownumbers: true,
//                     autowidth: true,
//                     shrinkToFit:false,
//                     loadComplete:function(data,a,b,c) {
//                         me.loadingEvent();
//                         if(data.records==0 && data.page>1){
//                             setTimeout(function(){me.search();},100);
//                         }
//                         current_db_rows=data.rows;
//                         var ids = me.gridObj.jqGrid('getDataIDs');
//                         if(ids!=null && ids.length>0){
//                             me.gridObj.jqGrid('setSelection',ids[0]);
//                         }
//                     },
//                     beforeSelectRow: function (rowid,e){
//                     },
//                     onSelectRow:function(rowid,status){
//                         /*	refreshShowButtonTop(rowid);
//                          refreshFbWindowBySelectRow(rowid);		*/	//表格组单击行刷新附表
//                     },
//                     onSelectAll:function(rowids,status){
//                     },
//                 }).jqGrid('setFrozenColumns');
//                 /*
//                  $(window).resize(function(){
//                  if(gridObj){
//                  gridObj.setGridWidth($(window).width()*(mBiLi/12)-5);
//                  }
//                  });
//                  $("#list_gridPager td").css({"padding":"0px 3px"});
//                  */
//             }

//             function createColList(jsonMap){
//                 me.buttonList= jsonMap.buttonList;
//                 me.fieldList= jsonMap.fieldList;
//                 var buttonList =me.buttonList;
//                 var fieldList =me.fieldList;
//                 var operatorColWidth=jsonMap.operatorColWidth;
//                 var isDownload=jsonMap.isDownload;
//                 var colList=[];
//                 if(isDownload){
//                     me.divObj.find(".button_content").append('<span bt_type="download" ><a target="_blank" class="btn btn-xs default-btn-img default-btn" isMain="1"  key="donwLoad"><i class="fa fa fa-download"></i>下载</a></span>');
//                 }
//                 var multflag=false;
//                 if(buttonList!=null && buttonList.length>0){
//                     $.each(buttonList,function(i,button){
//                         me.buttonConfigObj[button.sid]=button;
//                         if(button.isShow &&  button.isShow=="1"){
//                             if(button.type=="ADD"){
//                                 if(button.name.indexOf("批量") >= 0){
//                                     multflag=true;
//                                 }
//                                 var class_val = JsonButton.commonButton.default_btn+" "+JsonButton.commonButton.btn_add;
//                                 if(button.style){
//                                     var mesg = ctx+"/assetsv1/img/list/"+button.style+"_white.png";
//                                 }
//                                 me.divObj.find(".button_content").append('<button  key_id="'+button.sid+'" bt_type="ADD"  class="default-btn-img  '+class_val+'" type="button" >'+button.name+'</button>'
//                                 );
//                             }else{
//                                 if(button.type!="LINK") {
//                                     me.editDelButtonList.push(button);
//                                 }
//                             }
//                         }
//                     });
//                 }
//                 var showColCount=0;
//                 if(multflag){	//jqTable
//                     colList.push({frozen:true,label:"<input type='checkbox' class='all_select_comp'>",index:"allselect_compontent",name:"全选2",width:30,sortable:false,formatter:function(dbValue,x,n){
//                         return '<input type="checkbox" key="select_checkbox" rowid="'+ x.rowId+'" style="margin:12px 0 0 3px;">';
//                     }});
//                 }
//                 $.each(fieldList,function(i,field){
//                     var title=field.title;
//                     if(field.alias && field.alias.length>0){
//                         title=field.alias;
//                     }
//                     var colObj = {label:title,index:field.columnName,name:field.columnName,align:'left'};
//                     if(!field.isShow && field.isShow==0){
//                         colObj['hidden']=true;
//                     }else{
//                         showColCount++;
//                     }
//                     if(field.colWidth && (field.colWidth*1)>0){
//                         colObj['width']=(field.colWidth*1);
//                     }
//                     if(field.isFixed && field.isFixed==1){
//                         colObj['frozen']=true;
//                     }
//                     if(field.primaryKey && field.primaryKey==1){
//                         colObj['key']=true;
//                     }
//                     if(field.fieldType=="DATE" || field.fieldType=="DATETIME" || field.fieldType=="TIME"){
//                         var format="yyyy-MM-dd";
//                         if(field.fieldType=="DATETIME"){
//                             format="yyyy-MM-dd HH:mm:ss";
//                         }else if(field.fieldType=="TIME"){
//                             format="HH:mm:ss";
//                         }
//                         colObj['formatter']=function(v,x,n){
//                             if(v){
//                                 var date=new Date(v);
//                                 return me.textBZ(date.format(format),field.columnName, x.rowId,n,buttonList);
//                             }
//                             return me.textBZ(v,field.columnName, x.rowId,n,buttonList);
//                         }
//                     }else{
//                         colObj['formatter']=function(dbValue,x,n){
//                             return me.textBZ(dbValue,field.columnName, x.rowId,n,buttonList);
//                         }
//                     }
//                     colList.push(colObj);
//                 });
//                 if(me.editDelButtonList.length>0){
//                     if(!tableSetting || !tableSetting.showButtonTop){
//                         colList.push({
//                             label:"操作",
//                             index:"操作",
//                             name:"操作",
//                             align:"left",
//                             width:operatorColWidth?operatorColWidth:150,
//                             formatter:function(dbValue,x,n){
//                                 var buttonStr='';
//                                 $.each(me.editDelButtonList,function(i,button){
//                                     if(n.SHOW_BUTTON_IDS && existString(n.SHOW_BUTTON_IDS,button.sid)){
//                                         var class_val = JsonButton.spanButton.default_btn_select;
//                                         if(button.style){
//                                             var mesg = ctx+"/assetsv1/img/list/"+button.style+"_white.png";
//                                         }
//                                         buttonStr+='<span  key_id="'+button.sid+'" row_id="'+ x.rowId+'" bt_type="'+button.type+'" bt_mark="editOrDel" class="default-btn '+class_val+'" type="button"  style="margin: 0px 5px;background:rgba(72, 160, 220, 1) url('+mesg+') no-repeat 10px center" >'+button.name+'</span>'
//                                     }
//                                 });
//                                 return "<div style='display: inline-flex'>"+buttonStr+"</div>";
//                             }
//                         });
//                         showColCount++;
//                     }
//                 }
//                 return handlerColWidth(colList,showColCount);
//             };
//             me.initConditionList=function(filterObj,jsonMap){
//                 $.post(ctx+"/cloud/sbehaviourConfig/use/getConfig/TABLE_CONDITION",{id:me.tableId},function(json) {
//                     if (json.result == "Success" || json.result == "SUCCESS") {
//                         var conList = json.list;
//                         var hasShow = [];
//                         if (conList != null && conList.length > 0) {
//                             $.post(ctx + "/cloud/sbehaviourConfig/use/getConfig/TABLE_CONDITION_SETTING", {id: me.tableId}, function (result) {	//获取分类用户设置信息
//                                 if ((json.result == "Success" || json.result == "SUCCESS") && result.list != null && result.list.length > 0) {
//                                     var tableConditionSettingId = result.list[0].sid;
//                                     if (tableConditionSettingId && tableConditionSettingId.indexOf("10000") == -1) {
//                                         me.divObj.find("input[name=tableConditionSettingId]").val(result.list[0].sid);
//                                     }
//                                     var setting = JSON.parse(result.list[0].setting);
//                                     for (var i = 0; i < setting.length; i++) {
//                                         var userSet = setting[i];					//用户设置信息
//                                         $.each(conList, function (j, con) {
//                                             if (userSet.classifyId == con.sid) {
//                                                 me.conditionList[con.sid] = con;
//                                                 var conSet = JSON.parse(con.setting);	//搜索分类设置信息
//                                                 filterObj.showClassify({classifyId: con.sid,name: conSet.name,type: conSet.type,isShow: userSet.isShow,isDefault: userSet.isDefault});
//                                                 conList.splice(j, 1);			//移除已经添加过的分类
//                                                 return false;
//                                             }
//                                         });
//                                     }
//                                 }
//                                 //没有搜索字段用户设置信息或者一些分类设置后没有保存用户设置
//                                 $.each(conList, function (i, con) {
//                                     var setting = con.setting;
//                                     if (setting) {
//                                         me.conditionList[con.sid] = con;
//                                         var setObj = JSON.parse(setting);
//                                         filterObj.showClassify({classifyId: con.sid, name: setObj.name, type: setObj.type});
//                                     }
//                                 });
//                                 //【表单需在搜索分类设置加载之后初始化，以使默认搜索分类生效】
//                                 initTable(jsonMap);
//                             });
//                         }
//                     } else {
//                         tipsMsg(json.resultMsg, "FAIL");
//                     }
//                 });
//             }
//             /**
//              * 计算列宽
//              **/
//             function handlerColWidth(colList,showColCount){
//                 var sumCount=me.divWidth-50;
//                 var showColCount = 0 ;
//                 var isAllSelect=0;
//                 var existSumWidth=0;
//                 $.each(colList,function(i,obj){
//                     if(!obj.hidden){
//                         showColCount ++ ;
//                         if(obj.width && obj.width>0){
//                             existSumWidth+=(obj.width*1);
//                         }else{
//                             existSumWidth+=150;
//                         }
//                     }
//                     if(obj.index=="allselect_compontent" ){
//                         isAllSelect=1;
//                     }
//                 });
//                 if(isAllSelect){
//                     sumCount+=-30;
//                     showColCount--;
//                 }
//                 var sxWidth=0;
//                 if(existSumWidth<sumCount){
//                     sxWidth = ((sumCount-existSumWidth)/showColCount);
//                 }
//                 $.each(colList,function(i,obj){
//                     if(!obj.hidden){
//                         var curWidth = 150;
//                         if(obj.width && obj.width>0){
//                             curWidth=(obj.width)*1;
//                         }
//                         if(obj.index!="allselect_compontent"){
//                             obj.width=(curWidth+sxWidth);
//                         }
//                     }
//                 });
//                 return colList;
//             }
//         };
//         me.search=function(){
//             var data=me.getSearchCondition();
//             me.gridObj=$("#"+me.config.markId).jqGrid('setGridParam',{datatype:'json',postData:data,page:1}).trigger("reloadGrid"); //重新载入

//         };
//         me.getSearchParams=function(){
//             me.getSearchCondition();
//         };
//         me.getSearchCondition=function(){
//             var fieldKeys=[];
//             if(me.fieldList && me.fieldList.length>0){
//                 $.each(me.fieldList,function(i,obj){
//                     if(obj.isSearch && obj.isSearch==1){
//                         fieldKeys.push(obj.columnName);
//                     }
//                 });
//             }
//             //搜索分类的条件
//             var configObj=[];
//             var sqlExpression="";
//             var key_id=me.divObj.find(".dropdownTitle").attr("key_id");
//             if(key_id && me.conditionList[key_id]){
//                 var condition = me.conditionList[key_id];
//                 if(condition.setting){
//                     configObj=JSON.parse(condition.setting).conObj;
//                     sqlExpression=JSON.parse(condition.setting).sqlExpression;
//                 }
//             }
//             //快速检索的条件
//             var qqConObj=me.fastSearchxx.getQuickQueryConfig();
//             //搜索栏关键字
//             var keyword=$(me.divObj.find("input[name=keyword]")[0]).val();
//             return data={keyword:keyword,fieldKeys:JSON.stringify(fieldKeys),conObj:JSON.stringify(configObj),sqlExpression:sqlExpression,qqConObj:JSON.stringify(qqConObj)};
//         }
//         me.initHtml=function(){
//             me.divObj.css({"margin":"5px 0","border":"1px solid #EEE"});
//             var searchDiv=
//                     '<div class="search_head_div">'+
//                     '<div id="search" class="search">'+
//                     '<div class="dropdown">'+
//                     '<span class="pointer" style="position:relative;">' +'<span class="dropdownTitle">全部数据</span>' +'<span class="pl6" style="position:relative;"><img src="../../../images/searchFilter/dropdown.png" style="height: auto"></span></span>'+
//                     '<ul class="dropdown-content"><li key_id="0">全部数据</li><li data-toggle="modal" key="openAddClassModalBtn"><span><span><img class="middle" src="../../../images/searchFilter/set_icon.png" alt="设置"/><span>设置</span></span></span></li></ul>'+
//                     '</div>'+
//                     '<!-- 搜索框-->'+
//                     '<div class="form searchContent inlineBlock">'+
//                     '<span style="position: relative;"><input type="text" class="searchText" name="keyword" /><span class="table_search_btn" style="position: absolute;right: 20px;top: 0;color: #48a1dd;cursor: pointer"><img src="../../../images/searchFilter/search_icon.png" alt=""/><span>搜索</span></span></span><span name="quickQueryBtn" class="pointer" data-toggle="modal"><img src="../../../images/searchFilter/quick_search.png" alt="" style="height: 30px;width: 30px;"/></span>'+
//                     '</div>'+
//                     '<div class="btn-wrap button_content" style="padding-top: 8px;"></div>'+
//                     '<div class="btn-wrap show_button_top" style="padding-top: 8px;"></div>'+
//                     '</div>'+
//                     '</div>';
//             me.divObj.html(searchDiv);
//             me.divObj.append('<div id="tab-main" style="padding-left:0px;padding-right:0;" class="col-lg-12 col-sm-12 col-xs-12">'+
//             '<span class="set-table-btn" style="position: absolute;" ></span>'+
//             '<table id="'+me.config.markId+'" ></table>'+
//             '<div id="'+(me.config.markId)+'_gridPager"  style="height:30px;"></div>'+
//             '</div>');
//         };
//         me.textBZ=function(text,fieldKey,rowId,data,buttonList){
//             if(text || text==0){
//                 if(typeof text=="object"){
//                     text=JSON.stringify(text);
//                 }
//                 text=text+"";
//                 if(text.indexOf("###")!=-1){
//                     text=text.replace("###","");
//                     text = JSON.parse($.trim(text));
//                     var iconStr="";
//                     if(text.icon){
//                         iconStr="<label class='"+text.icon+"'></label>";
//                     }
//                     var styleStr="";
//                     if(text.background && text.background.toLowerCase()!="#ffffff"){
//                         styleStr="style='color:"+text.background+";'";
//                     }
//                     if(text.change_text){
//                         text = iconStr + '<label key_change="1" rowId="'+rowId+'" key_value="'+text.value+'" '+styleStr+'>'+text.change_text+"</label>"
//                     }
//                 }
//                 //处理超链接
//                 if(buttonList && buttonList.length>0){
//                     $.each(buttonList,function(i,obj){
//                         if(obj.type=="LINK" && obj.name==fieldKey && obj.isShow && obj.isShow=="1"){
//                             if(data.SHOW_BUTTON_IDS && data.SHOW_BUTTON_IDS.length>0){
//                                 for(var mk in data.SHOW_BUTTON_IDS){
//                                     if(data.SHOW_BUTTON_IDS[mk]==obj.sid){
//                                         text='<a key_id="'+obj.sid+'" style="width:100%;text-align: left;" bt_type="LINK" type="button" row_id="'+rowId+'">'+text+'</a>'
//                                     }
//                                 }
//                             }
//                         }
//                     });
//                 }
//             }
//             if(typeof  text!="number"){
//                 if(!text)
//                     text="";
//                 text=tableContextHandler(text);
//             }
//             return '<label style="display:inline-flex;width:100%;text-align: left;height:25px;">'+text+'</label>';
//         };
//         /**
//          * 单击按钮
//          **/
//         me.clickButton=function(obj){
//             obj =  $(obj);
//             var data={};
//             var selectRowData = me.getSelectRowObj(obj);
//             var buttonText = obj.text();
//             if(selectRowData && selectRowData.length>0){
//                 data['form']={"selectRows":JSON.stringify(selectRowData)};
//                 var ids="";
//                 $.each(selectRowData,function(i,sobj){
//                     if(sobj.id){
//                         if(ids){
//                             ids+=","+sobj.id;
//                         }else{
//                             ids+=sobj.id;
//                         }
//                     }
//                 });
//                 data['form']['selectIds']=ids;
//             }else{
//                 if(buttonText && buttonText.indexOf("批量")!=-1){
//                     tipsMsg("请勾选需要"+buttonText+"的数据","FAIL");
//                     return;
//                 }
//             }
//             if(!data['form']){
//                 data['form']={};
//             }
//             if(me.form_db){
//                 for (var pd in me.form_db) {
//                     if (form_db[pd] && !data['form'][pd]) {
//                         data['form'][pd] = form_db[pd];
//                     }
//                 }
//             }
//             if(me.form_pm_obj){
//                 for (var pd in me.form_pm_obj) {
//                     if (me.form_pm_obj[pd]) {
//                         data['form'][pd]=me.form_pm_obj[pd];
//                     }
//                 }
//             }
//             data['sys']=me.sys_db;
//             var btType=obj.attr("bt_type");
//             var row_id = obj.attr("row_id");
//             if((btType=="EDIT" || btType=="DELETE" || btType=="LINK") && row_id){
//                 data['table']=me.getTableRowDb(row_id);
//             }
//             if(btType=="DELETE"){
//                 confirmMsg("是否确认"+buttonText,function(){
//                     btf.button.clickButton(obj,me.buttonConfigObj,data,function(){
// //						if(idKey && pIdKey){	//zTree
// //							initTree();
// //						}else{
//                         me.gridObj.trigger("reloadGrid");
// //						};
//                     });
//                 });
//             }else if(buttonText && buttonText.indexOf("批量")!=-1){
//                 popMsgTip("是否确认"+buttonText,function(){
//                     btf.button.clickButton(obj,me.clickButton,data,function(){
// //						if(idKey && pIdKey){	//zTree
// //							initTree();
// //						}else{					//jqGird
//                         me.gridObj.trigger("reloadGrid");
// //						};
//                     });
//                 });
//             }else{
//                 btf.button.clickButton(obj,me.buttonConfigObj,data,function(){
// //					if(idKey && pIdKey){	//zTree
// //						initTree();
// //					}else{					//jqGird
//                     me.gridObj.trigger("reloadGrid");
// //					};
//                 });
//             }
//         };
//         /**
//          * 获取选中的行
//          **/
//         me.getSelectRowObj=function(){
//             var data=[];
// //			if(idKey && pIdKey){//zTree
// //				var treeObj = $.fn.zTree.getZTreeObj("list_tree");
// //				if(treeObj){
// //					//var rowId=$(me).parents("li").attr("id");
// //					var rowId = $(me).attr("row_id");
// //					if(rowId){			//单击行或者修改删除按钮
// //						data.push(treeObj.getNodeByTId(rowId));
// //					}else{				//批量按钮
// //						data = treeObj.getCheckedNodes(true);
// //					}
// //				}
// //			}else{				//jqGird
//             $("#list_grid_frozen").find("input[key=select_checkbox]").each(function(i,obj){
//                 if(obj.checked==true){
//                     var rowid = $(obj).attr("rowid");
//                     data.push(getTableRowDb(rowid));
//                 }
//             });
// //			}
//             return data;
//         };
//         /**
//          * 获取当前行
//          **/
//         me.getTableRowDb=function(rowId,notSelect){
//             function getBakValue(value){
//                 if(value && typeof value=="string"){
//                     if(value.indexOf("###")!=-1){
//                         value=value.replace("###","");
//                         var tempJson=JSON.parse(value);
//                         return tempJson.value;
//                     }
//                 }
//                 return value;
//             }
//             if(rowId){
//                 var rowData ={};
//                 me.current_select_data=rowData;
//                 /*if(idKey && pIdKey){	//zTree
//                  var treeObj = $.fn.zTree.getZTreeObj("list_tree");
//                  rowData=treeObj.getNodeByTId(rowId);
//                  for(var i in rowData){
//                  rowData[i]=getBakValue(rowData[i]);
//                  }
//                  current_select_data=rowData;
//                  }else{	*/				//jqGird
//                 if(!notSelect){
//                     me.gridObj.jqGrid('setSelection',rowId);
//                 }
//                 var rowIndex;
//                 var s = me.gridObj.jqGrid('getDataIDs');
//                 for(var i=0;i< s.length;i++){
//                     if(s[i]==rowId){
//                         rowIndex=i+1;
//                         break;
//                     }
//                 }
//                 if(rowIndex && rowIndex>0){
//                     rowData =current_db_rows[rowIndex-1];
//                     for(var i in rowData){
//                         rowData[i]=getBakValue(rowData[i]);
//                     }
//                     me.current_select_data=rowData;
//                 }
// //				}
//                 var selectRow={};
//                 for(var i in me.current_select_data){
//                     if(me.current_select_data[i]){
//                         selectRow[i]=me.current_select_data[i];
//                     }
//                 }
//                 return selectRow;
//             }
//             return {};
//         }
//     };


//     /**
//      * 表格过滤器
//      * */
//     function tableFilter(divObj,tableObj,fieldList,fieldTypeList,fastSearchObj){
//         var me = this;
//         me.divObj = divObj;
//         me.tableObj=tableObj;
//         me.fieldList=fieldList;
//         me.fastSearchObj = fastSearchObj;
//         me.conditionList=tableObj.conditionList;
//         me.fieldStr="";
//         me.allFieldSearch=false;
//         me.fieldTypeList=fieldTypeList;
//         me.initEvent=function(){
//             //实现模态框拖拽
//             me.divObj.find(".modal").draggable({
//                 handle: ".modal-header", // 只能点击头部拖动
//                 cursor: "pointer"
//             });
//             $(me.divObj.find("div[name=addConditionModal]")[0]).css("overflow", "hidden");//禁止模态对话框的半透明背景滚动
//             //table 排序和拖拽
//             me.divObj.find("table[name=addClassTable]").sortable({
//                 cursor:"pointer",
//                 items:"tr",
//                 opacity:0.6,
//                 delay:300,
//                 sort:true,
//                 disabled:false,
//                 revert:false,
//                 stop:function(event,ui){

//                 }
//             });
//             //是否显示 控制开关
//             me.divObj.find("table[name=addClassTable]").on('click','.div1',function() {
//                 $(this).toggleClass('close1');
//                 $(this).toggleClass('open1');
//                 $(this).find(".div2").toggleClass('close2');
//                 $(this).find(".div2").toggleClass('open2');
//             });
//             //只能选择一个默认分类
//             me.divObj.find("table[name=addClassTable]").on("click","input[name=default]",function(){
//                 if($(this).prop("checked")){
//                     me.divObj.find("table[name=addClassTable]").find("input[name=default]").not(this).prop("checked",false);
//                 }
//             });
//             //选中分类的一行进行选中 只能选中一行
//             me.divObj.find("table[name=addClassTable]").on("click","tr",function(){
//                 if($(this).hasClass("rowSelected")){
//                     $(this).removeClass("rowSelected")
//                 }else{
//                     $(this).addClass("rowSelected");
//                     $(this).siblings().removeClass("rowSelected")
//                 }
//             });
//             //删除选中的搜索分类
//             me.divObj.find("span[key=delete_classify_btn]").on("click",function(){
//                 me.removeClassify();
//             });
//             //新增搜索分类
//             me.divObj.find("span[key=open_addConditionModal_btn]").bind("click",function(){
//                 me.resetConditionModal();
//                 $(me.divObj.find("div[name=addConditionModal]")[0]).modal('show');
//             });
//             //编辑搜索分类
//             me.divObj.find("table[name=addClassTable]").on("click","img[key=edit_classify_btn]",function(){
//                 var obj = this;
//                 $(me.divObj.find("div[name=addConditionModal]")[0]).modal('show');
//                 me.editClassify(obj);
//             });
//             //新增分线栏
//             me.divObj.find("span[key=open_addLineModal_btn]").on("click",function(){
//                 me.divObj.find("div[name=addLineModal]").find("input[name=classify_id]").val("");
//                 me.divObj.find("div[name=addLineModal]").find("input[name=classify_name]").val("");
//                 $(me.divObj.find("div[name=addLineModal]")[0]).modal('show');
//             });
//             //编辑分线栏
//             me.divObj.find("table[name=addClassTable]").on("click","img[key=edit_line_btn]",function(){
//                 var obj = this;
//                 var classify_id=$(obj).parents("tr").attr("key_id");
//                 var classify_name=$(obj).parents("tr").find("input[type=text]").val();
//                 me.divObj.find("div[name=addLineModal]").find("input[name=classify_id]").val(classify_id);
//                 me.divObj.find("div[name=addLineModal]").find("input[name=classify_name]").val(classify_name);
//                 $(me.divObj.find("div[name=addLineModal]")[0]).modal('show');
//             });
//             //保存分线栏
//             me.divObj.find("button[key=addLineModal_save_btn]").bind("click",function(){
//                 me.addLine();
//             });

//             //保存搜索分类设置信息(排序，启用，默认)
//             me.divObj.find("div[name=addClassModal]").on("click","button[key=save_classify_setting_btn]",function(){
//                 me.fastSearchObj.saveClassifySetting(true);
//             });


//             //点击回退,返回上一层模态框
//             me.divObj.find("div[name=addConditionModal]").on("click","span[key=backToPre]",function(){
//                 $(me.divObj.find("div[name=addConditionModal]")[0]).modal('hide');
//             });
//             //保存搜索分类
//             me.divObj.find("button[key=addConditionModal_save_btn]").bind("click",function(){
//                 me.saveClassify();
//             });
//             //新增搜索字段
//             me.divObj.find("span[key=addFieldSearch]").bind("click",function(){
//                 me.addFieldSearch();
//             });
//             //切换一级搜索分类
//             me.divObj.find(".dropdown-content").on("click","li",function(){
//                 if($(this).attr("key_id")){
//                     //切换一级分类时清空搜索框及快速检索表单
//                     //$("#clearQueryData").click();
//                     me.divObj.find(".fastSearch_clean").click();
//                     $(me.divObj.find("input[name=keyword]")[0]).val("");

//                     me.divObj.find(".dropdownTitle").text($(this).text()).attr("key_id",$(this).attr("key_id"));
//                     me.tableObj.search();
//                 }
//             })
//         };
//         me.addFieldSearch=function(){
//             var me = this;
//             var tr = $('<tr>'+
//             '<td width="5%" class="td">'+(me.divObj.find("table[name=addConditionTable] tr").length+1)+'</td>'+
//             '<td width="25%">'+
//             '<select class="custom-select select_field_com" style="width:130px;" name="field">' +
//             me.fieldStr+
//             '</select>'+
//             '</td>'+
//             '<td width="25%">'+
//             '<select class="custom-select select_con_com" style="width:130px;" name="condition" ></select>'+
//             '</td>'+
//             '<td width="40%">'+
//             '<input type="text" style="width: 100px;" name="value" class="input" >'+
//             '<div class="time-before">'+
//             '<select class="custom-select" name="unit" style="text-indent:8px;width:60px;margin-left:5px;">'+
//             '<option  value="DAY">天</option>'+
//             '<option value="WEEK">周</option>'+
//             '<option value="MONTH">月</option>'+
//             '<option value="QUARTER">季度</option>'+
//             '<option value="YEAR">年</option>'+
//             '</select>'+
//             '</div>'+
//             '<div class="time-date">'+
//             '<input type="text" style="width: 100px;" name="start_value"  class="input" />'+
//             '<input type="text" style="width: 100px;margin-left:5px;" name="end_value" class="input" />'+
//             '</div>'+
//             '</td>'+
//             '<td width="5%">'+
//             '<span class="delRow pointer pl12" >'+
//             '<img class="middle" src="../../../images/searchFilter/delete-selete.png" alt="删除"/>'+
//             '</span>'+
//             '</td>'+
//             '</tr>');

//             tr.find(".select_field_com").bind("change",function(){
//                 var obj = this;
//                 me.changeField(obj);
//             });
//             tr.find(".select_con_com").bind("change",function(){
//                 var obj = this;
//                 me.changeCondition(obj);
//             });
//             tr.find(".delRow").bind("click",function(){
//                 var obj = this;
//                 me.removeFieldSearch(obj);
//             });
//             me.divObj.find("table[name=addConditionTable]").append(tr);
//             var lastTr = me.divObj.find("table[name=addConditionTable]").find("tr").last();
//             me.changeField(lastTr.find("select[name=field]").last());
//             lastTr.find(".time-date input").each(function(i,obj){
//                 laydate.render({
//                     elem:obj //指定元素
//                 });
//             });
//         };

//         /**
//          * 切换搜索字段
//          */
//         me.changeField=function(obj){
//             obj = $(obj);
//             var value = obj.val();
//             var type=$(obj.parent().find('option[value="'+value+'"]')[0]).attr("key_type");
//             if(type){
//                 type=type.toLocaleUpperCase();
//             }
//             var quote=$(obj.parent().find('option[value="'+value+'"]')[0]).attr("quote");
//             var convert=$(obj.parent().find('option[value="'+value+'"]')[0]).attr("convert");
//             var fieldTypeStr = '<option value="">请选择</option>';
//             if(me.fieldTypeList && me.fieldTypeList.length>0){
//                 for(var i=0;i<me.fieldTypeList.length;i++){
//                     if(me.fieldTypeList[i].name==type){
//                         if(me.fieldTypeList[i].conList && me.fieldTypeList[i].conList.length>0){
//                             $.each(me.fieldTypeList[i].conList,function(i,obj){
//                                 if(obj.name=="QUOTE"){
//                                     if(quote){
//                                         fieldTypeStr ='<option value="'+obj.name+'">'+obj.desc+'</option>';
//                                         return;
//                                     }
//                                 }else if(obj.name=="CONVERT"){
//                                     if(convert){
//                                         fieldTypeStr ='<option value="'+obj.name+'">'+obj.desc+'</option>';
//                                         return;
//                                     }
//                                 }else{
//                                     fieldTypeStr +='<option value="'+obj.name+'">'+obj.desc+'</option>';
//                                 }
//                             });
//                         }
//                     }
//                 }
//             }
//             $(obj.parent().parent().find("select[name=condition]")[0]).html(fieldTypeStr);
//             $(obj.parent().parent().find("select[name=condition]")[0]).change();
//         }

//         /**
//          * 切换搜索字段类型
//          */
//         me.changeCondition=function(obj){
//             obj = $(obj);
//             obj.parent().parent().find(".time-date").hide()
//             obj.parent().parent().find(".time-before").hide()
//             obj.parent().parent().find("input[name=value]").hide();
//             obj.parent().parent().find("div.ms-ctn").remove();
//             var value= obj.val();
//             if(value=="TODAY" || value=="THIS_WEEK" || value=="THIS_MONTH" || value=="THIS_SEASON" ||value=="THIS_YEAR" || value=="NULL"  || value=="NOT_NULL" || value=="TOMORROW" || value =="YESTERDAY" || value =="NEXT_WEEK" || value =="UP_WEEK" || value =="NEXT_MONTH" || value =="UP_MONTH" || value =="NEXT_SEASON"  || value =="UP_SEASON" || value =="NEXT_YEAR" || value =="UP_YEAR"
//             ){
//                 obj.parent().parent().find("input[name=value]").hide();
//             } else if(value == "L_" || value=="N_") {
//                 obj.parent().parent().find(".time-before").css("display","inline-block")
//                 obj.parent().parent().find("input[name=value]").show();
//             } else if(value == "IN"){
//                 obj.parent().parent().find(".time-date").css("display","inline-block")
//             } else if(value == "QUOTE"){	//引用
//                 obj.parent().parent().find("input[name=value]").after('<input type="text" style="width: 130px;float:left" name="temp">');
//                 var quoteStr=obj.parent().parent().find("[name='field']").find('option:selected').attr("quote");
//                 if(quoteStr){
//                     var defaultValue=[];	//修改时显示原来的值
//                     var oldValue=obj.parent().parent().find("input[name=value]").val();
//                     if(oldValue){
//                         defaultValue=oldValue.split("|#|");
//                     }
//                     var quote=JSON.parse(quoteStr);
//                     var wordbookId=quote.id;
//                     var fieldKey=quote.field_key;
//                     var params={};
//                     if(quote.params){
//                         for(var i=0;i<quote.params.length;i++){
//                             var p = quote.params[i];
//                             if(p.p_name && p.p_value){
//                                 params[p.p_name]=p.p_value;
//                             }
//                         }
//                     }
//                     if(wordbookId && fieldKey){
//                         obj.parent().parent().find("input[name=temp]").magicSuggest({
//                             data: ctx+"/cloud/table/list/reader/wordbook/"+wordbookId,
//                             allowFreeEntries: false,
//                             autoSelect:true,
//                             dataUrlParams:params,
//                             value:defaultValue,
//                             valueField:fieldKey,
//                             maxSelection:1000,//设置选择个数
//                             placeholder: "请选择",
//                             displayField:fieldKey,//定义显示的字段
//                             maxSelectionRenderer:function(){
//                                 return "";
//                             },
//                             selectionRenderer:function(data){
//                                 var value=data[fieldKey];
//                                 return value;
//                             }
//                         });
//                     }
//                 }
//             } else if(value == "CONVERT"){	//转换
//                 obj.parent().parent().find("input[name=value]").after('<input type="text" style="width: 130px;float:left" name="temp">');
//                 var convertStr=obj.parent().parent().find("[name='field']").find('option:selected').attr("convert");
//                 if(convertStr){
//                     var defaultValue=[];	//修改时显示原来的值
//                     var oldValue=obj.parent().parent().find("input[name=value]").val();
//                     var optionArr=[];
//                     var convertArr=JSON.parse(convertStr);
//                     for(var i=0;i<convertArr.length;i++){
//                         var temp = {"value":JSON.stringify(convertArr[i].filter),"name":convertArr[i].change_text};
//                         optionArr.push(temp);
//                         if(oldValue && oldValue.indexOf(JSON.stringify(convertArr[i].filter))!=-1){
//                             defaultValue.push(temp);
//                         }
//                     }
//                     obj.parent().parent().find("input[name=temp]").magicSuggest({
//                         data: optionArr,
//                         allowFreeEntries: false,
//                         autoSelect:true,
//                         value:defaultValue,
//                         valueField:"value",
//                         maxSelection:1000,//设置选择个数
//                         placeholder: "请选择",
//                         displayField:"name",//定义显示的字段
//                         maxSelectionRenderer:function(){
//                             return "";
//                         },
//                         selectionRenderer:function(data){
//                             var value=data[fieldKey];
//                             return data["name"];
//                         }
//                     });
//                 }
//             } else{
//                 obj.parent().parent().find("input[name=value]").show();
//             }
//         }

//         /**
//          * 保存搜索分类
//          */
//         me.saveClassify=function(){
//             var me = this;
//             var classify_name=me.divObj.find("div[name=addConditionModal]").find("input[name=classify_name]").val();
//             var classify_id=me.divObj.find("div[name=addConditionModal]").find("input[name=classify_id]").val();
//             if(!classify_name){
//                 me.divObj.find("div[name=addConditionModal]").find("input[name=classify_name]").focus();
//                 tipsMsg("请输入分类名称","FAIL");
//                 return;
//             }
//             if(classify_id && classify_id.indexOf("10000")!=-1){
//                 tipsMsg("公共条件不能修改","FAIL");
//                 return;
//             }
//             var conObj=me.getDbConfig(me.divObj.find("div[name=addConditionModal]").find("[name=addConditionTable] tr"));
//             var sqlExpression=me.divObj.find("div[name=addConditionModal]").find("textarea[name=sqlExpression]").val();
//             if(conObj && conObj.length>0){
//                 var setting={name:classify_name,sqlExpression:sqlExpression,conObj:conObj};
//                 $.post(ctx+"/cloud/sbehaviourConfig/use/saveConfig/TABLE_CONDITION",{setting:JSON.stringify(setting),tableId:me.tableObj.tableId,id:classify_id},function(json){
//                     if(json.result=="Success" || json.result=="SUCCESS"){
//                         if(classify_id){	//修改分类
//                             me.divObj.find("div[name=addConditionModal] tbody").find("tr[key_id="+classify_id+"]").find("td:first").text(classify_name);
//                         }else{	//新增分类
//                             me.showClassify({classifyId:json.map.obj.sid,name:classify_name});
//                         }
//                         var obj=json.map.obj;
//                         me.conditionList[obj.sid]=obj;
//                         me.divObj.find("div[name=addConditionModal]").modal("hide");
//                         me.fastSearchObj.saveClassifySetting();
//                     }else{
//                         tipsMsg(json.resultMsg,"FAIL");
//                     }
//                 })
//             }else{
//                 tipsMsg("请设置搜索条件","FAIL");
//             }
//         }

//         /**
//          * 修改搜索分类
//          */
//         me.editClassify=function(obj){
//             var me = this;
//             me.resetConditionModal();
//             //设置分类name、id属性
//             var key_id=$(obj).parents("tr").attr("key_id");
//             var isCopy=$(obj).attr("is-copy");
//             var conObj = me.conditionList[key_id];
//             if(conObj && conObj.setting){
//                 var setting = JSON.parse(conObj.setting);
//                 if(isCopy && isCopy=="0"){
//                     me.divObj.find("[name=addConditionTable]").parent().find("input[name=classify_id]").val(key_id);
//                     me.divObj.find("[name=addConditionTable]").parent().find("input[name=classify_name]").val(setting.name);
//                 }
//                 me.setConditionFields(setting.conObj,setting.sqlExpression);
//             }
//         }

//         /**
//          *删除搜索分类
//          */
//         me.removeClassify=function(){
//             var classifyId=me.divObj.find("table[name=addClassTable]").find(".rowSelected").attr("key_id");
//             if(classifyId){
//                 if(classifyId.indexOf("10000")!=-1){	//公共分类不能删除
//                     tipsMsg("公共分类不能删除","FAIL");
//                     return;
//                 }
//                 confirmMsg("确定要删除该分类吗",function () {
//                     $.post(ctx+"/cloud/sbehaviourConfig/use/remove/config",{id:classifyId},function(json){
//                         if(json.result=="Success" || json.result=="SUCCESS"){
//                             me.divObj.find("table[name=addClassTable]").find(".rowSelected").remove();
//                             delete me.conditionList[classifyId];
//                             //删除的分类为当前选中的分类，切换为全部数据
//                             var currClassify=me.divObj.find(".dropdownTitle").attr("key_id");
//                             if(currClassify && currClassify==classifyId){
//                                 me.divObj.find(".dropdown-content").find("li:first").click();
//                             }
//                             me.fastSearchObj.saveClassifySetting();
//                         }else{
//                             tipsMsg(json.resultMsg,"FAIL");
//                         }
//                     });
//                 });
//             }
//         }

//         /**
//          * 移除搜索字段
//          */
//         me.removeFieldSearch=function(obj){
//             obj = $(obj);
//             var tableObj=obj.parents("table");
//             obj.parents("tr").remove();
//             tableObj.find("tr").each(function(i,o){
//                 $(o).find("td").first().html(i+1);
//             });
//         }

//         /**
//          * 保存分线栏
//          */
//         me.addLine=function(){
//             var classify_id=me.divObj.find("div[name=addLineModal]").find("input[name=classify_id]").val();
//             var classify_name=me.divObj.find("div[name=addLineModal]").find("input[name=classify_name]").val();
//             if(!classify_name){
//                 tipsMsg("请输入分线栏名称","FAIL");
//                 return;
//             }
//             var setting={name:classify_name,type:"line"};
//             $.post(ctx+"/cloud/sbehaviourConfig/use/saveConfig/TABLE_CONDITION",{setting:JSON.stringify(setting),tableId:me.tableObj.tableId,id:classify_id},function(json){
//                 me.divObj.find("div[name=addLineModal]").modal("hide");
//                 if(json.result=="Success" || json.result=="SUCCESS"){
//                     if(classify_id){	//修改
//                         var size=classify_name.length>8?14:(classify_name.length*1.5);
//                         me.divObj.find("table[name=addClassTable] tbody").find("tr[key_id="+classify_id+"]").find("input[type=text]").val(classify_name).attr("size",size);
//                     }else{	//新增
//                         me.showClassify({classifyId:json.map.obj.sid,name:classify_name,type:"line"});
//                     }
//                     var obj=json.map.obj;
//                     //conditionList[obj.sid]=obj;
//                     //showClassify({classifyId:obj.sid,name:classify_name,type:'line'});
//                     me.saveClassifySetting();
//                 }else{
//                     tipsMsg(json.resultMsg,"FAIL");
//                 }
//             })
//         }


//         /**
//          * 重置搜索分类编辑弹窗
//          */
//         me.resetConditionModal=function(){
//             me.divObj.find("[name=addConditionTable]").parent().find("input[name=classify_id]").val("");
//             me.divObj.find("[name=addConditionTable]").parent().find("input[name=classify_name]").val("");
//             me.divObj.find("[name=addConditionTable]").parent().find("textarea[name=sqlExpression]").val("");
//             me.divObj.find("[name=addConditionTable]").empty();
//         }

//         /**
//          * 回显查询条件
//          **/
//         me.setConditionFields=function(configObj,sqlExpression){
//             if(configObj && configObj.length>0){
//                 //回显当前选中分类搜索条件
//                 $.each(configObj,function(i,field){
//                     me.addFieldSearch();
//                     var lastFieldTr=$("[name=addConditionTable] tr").last();
//                     for(var key in field){
//                         lastFieldTr.find("[name^="+key+"]").val(field[key]);
//                     }
//                     lastFieldTr.find("select[name=field]").val(field.field_key).change();
//                     lastFieldTr.find("[name=condition]").val(field["con"]).change();
//                 });
//             }
//             if(sqlExpression){
//                 $("[name=addConditionTable]").parent().find("textarea[name=sqlExpression]").val(sqlExpression);
//             }
//         }
//         /**
//          * 显示搜索分类(快速选择下拉项、编辑界面)
//          */
//         me.showClassify=function(userSetting){
//             var defaultSetting={classifyId:"",name:"",isShow:true,isDefault:false,type:""};
//             $.extend(defaultSetting, userSetting);	//以传入参数覆盖默认设置信息
//             var name=defaultSetting.name;
//             var classifyId=defaultSetting.classifyId;
//             var isShow=defaultSetting.isShow;
//             var isDefault=defaultSetting.isDefault;
//             if(defaultSetting.type && defaultSetting.type=="line"){	//分线栏
//                 var size=name.length>8?14:(name.length*1.5);
//                 me.divObj.find("table[name=addClassTable] tbody").append('<tr key_id="'+classifyId+'" class="newPartingLine">'
//                 +'<td colspan="3">'
//                 +'<div>'
//                 +'<input type="text" size="'+size+'" value="'+name+'" readonly/>'
//                 + '</div>'
//                 +'</td>'
//                 +'<td>'
//                 +'<span><img class="middle" src="../../../images/searchFilter/pencil-selete.png" alt="编辑" title="编辑" key="edit_line_btn"/></span>'
//                 +'</td>'
//                 +'</tr>');
//                 me.divObj.find(".dropdown-content").find("li:last").before('<li>'
//                 +'<div class="newPartingLine" style="height:40px;">'
//                 +'<div>'
//                 +'<label>'+name+'</label>'
//                 +'</div>'
//                 +'</div></li>');
//                 return;
//             }
//             var editStr='<span><img class="middle" src="../../../images/searchFilter/pencil-selete.png" alt="编辑" title="编辑" key="edit_classify_btn" is-copy="0"/></span>';
//             if(classifyId && classifyId.indexOf("10000")!=-1){	//普通用户不能修改公共条件
//                 editStr="";
//                 name += "(公共)";
//             }
//             me.tableObj.divObj.find("table[name=addClassTable]").find("tbody").append(
//                     '<tr key_id="'+classifyId+'">'+
//                     '<td>'+name+'</td>'+
//                     '<td>'+
//                     '<div class="div1 '+(isShow?"close1":"open1")+'">'+
//                     '<span class="left"></span>'+
//                     '<span class="right"></span>'+
//                     '<div class="div2 '+(isShow?"close2":"open2")+'"></div>'+
//                     '</div>'+
//                     '</td>'+
//                     '<td>'+
//                     '<span class="checkboxContent" style="position: relative;">'+
//                     '<input type="checkbox" name="default" '+(isDefault?"checked":"")+' id="'+classifyId+'"/>'+
//                     '<label for="'+classifyId+'"></label>'+
//                     '</span>'+
//                     '</td>'+
//                     '<td>'+
//                     editStr+
//                     '<span class="copyTr pl6"><img class="middle" src="../../../images/searchFilter/copy.png" alt="复制"  title="复制" key="edit_classify_btn" is-copy="1"/></span>'+
//                     '</td>'+
//                     '</tr>'
//             );
//             if(defaultSetting.isShow){
//                 me.divObj.find(".dropdown-content").find("li:last").before('<li key_id="'+classifyId+'"><span>'+name+'</span></li>');
//             }
//             if(defaultSetting.isDefault){
//                 me.divObj.find(".dropdownTitle").text(name).attr("key_id",classifyId);
//             }
//         }



//         /**
//          * 将搜索分类编辑弹窗的字段解析位json字段
//          */
//         me.getDbConfig=function(trList){
//             var conObj=[];
//             trList.each(function(i,obj){
//                 obj = $(obj);
//                 var field=obj.find("select[name=field]").val();
//                 var condition=obj.find("select[name=condition]").val();
//                 var value=obj.find("input[name=value]").val();
//                 if(condition=="CONVERT"){
//                     var convert=[];
//                     obj.find("input[name='temp[]']").each(function() {
//                         convert.push(JSON.parse($(this).val()));
//                     });
//                     value=JSON.stringify(convert);
//                 }else if(condition=="QUOTE"){
//                     value=obj.find("input[name='temp[]']").map(function() {
//                         return $(this).val();
//                     }).get().join("|#|");
//                 }
//                 var end_val=obj.find("input[name=end_value]").val();
//                 var start_val=obj.find("input[name=start_value]").val();
//                 var unit=obj.find("select[name=unit]").val();
//                 conObj.push({field_key:field,con:condition,value:value,end_val:end_val,start_val:start_val,unit:unit});
//             });
//             return conObj;
//         }

//         me.init=function(){
//             var me = this;
//             initHtml();
//             me.initEvent();
//             var fieldStr="";
//             if(me.fieldList && me.fieldList.length>0){
//                 $.each(me.fieldList,function(i,field){
//                     if(me.allFieldSearch || field.isSearch=="1" || field.isShowSearch=="1"){
//                         fieldStr+='<option key_type="'+field.fieldType+'" ';
//                         if(field.setting){
//                             var setting = JSON.parse(field.setting);
//                             if(!jQuery.isEmptyObject(setting.wordbook)){
//                                 fieldStr+='quote=\''+JSON.stringify(setting.wordbook)+'\' ';
//                             }
//                             if(setting.showSetting && setting.showSetting.length>0){
//                                 fieldStr+='convert=\''+JSON.stringify(setting.showSetting)+'\' ';
//                             }
//                         }
//                         fieldStr+='value="'+field.columnName+'">'+field.title+'</option>';
//                     }
//                 });
//             }
//             me.fieldStr=fieldStr;
//             function initHtml(){
//                 me.divObj.append(
//                         '<!---表单--->'+
//                         '<div  class="modal fade"  name="addClassModal" tabindex="-1" role="dialog" aria-labelledby="addClassModalLabel" data-backdrop="static">'+
//                         '<div class="modal-dialog" role="document">'+
//                         '<div class="modal-content">'+
//                         '<div class="modal-header modalColor">'+
//                         '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+
//                         '<h5 class="modal-title" name="addClassModalLabel"><span><img class="middle" src="../../../images/searchFilter/set_icon.png" alt="设置分类"/><span class="middle">设置分类</span></span></h5>'+
//                         '</div>'+
//                         '<div class="modal-body">'+
//                         '<div class="action" style="padding-top: 0;height: 40px;">'+
//                         '<span class="pointer pl6" key="open_addConditionModal_btn"><span><img class="middle" src="../../../images/searchFilter/add-selete.png" alt="添加分类"/><span class="middle">添加分类</span></span></span>'+
//                         '<span class="pointer pl12" key="open_addLineModal_btn" ><img class="middle" src="../../../images/searchFilter/add-selete.png" alt="添加分线栏"/><span class="middle">添加分线栏</span></span>'+
//                         '<span class="pointer pl12" key="delete_classify_btn"><img class="middle" src="../../../images/searchFilter/delete-selete.png" alt="删除"/><span class="middle">删除</span></span>'+
//                         '</div>'+
//                         '<input type="hidden" name="tableConditionSettingId">'+
//                         '<table name="addClassTable" class="connectedSortable" style="width: 100%" border="0" cellspacing="0" cellpadding="0"><thead><tr bgcolor="#e4e8ec"><td>名称</td><td>是否显示</td><td>设置为默认</td><td>操作</td></tr></thead><tbody></tbody></table>'+
//                         '</div>'+
//                         '<div class="modal-footer textCenter"><button type="button" key="save_classify_setting_btn"  class="btn btn-primary">保存</button><button type="button" class="btn btn-default" data-dismiss="modal">关闭</button></div>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'+
//                         '<!--分割线--->'+
//                         '<div  class="modal fade"  name="addConditionModal" tabindex="-1" role="dialog" aria-labelledby="addConditionModalLabel" data-backdrop="static">'+
//                         '<div id="modalDialog" class="modal-dialog" role="document">'+
//                         '<div class="modal-content">'+
//                         '<div class="modal-header modalColor">'+
//                         '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+
//                         '<h5 class="modal-title" name="addConditionModalLabel"><span><img class="middle" src="../../../images/searchFilter/set_icon.png" alt="设置分类"/></span><span class="middle">设置分类</span></h5>'+
//                         '</div>'+
//                         '<div class="modal-body">'+
//                         '<div class="action operation">'+
//                         '<span key="backToPre" key="ft">回退</span>'+
//                         '<span class="right pointer" key="addFieldSearch"><span><img class="middle" src="../../../images/searchFilter/addCondition.png" alt="添加操作"/><span class="middle">添加操作</span></span></span>'+
//                         '</div>'+
//                         '<div key="flname_div"><input type="hidden" name="classify_id">分类名称：<input type="text" style="width: 350px;" name="classify_name" class="input" placeholder="请输入分类名称"  maxlength="10"></div>'+
//                         '<table name="addConditionTable" class="connectedSortable" style="width: 100%;margin-top:10px;" border="0" cellspacing="0" cellpadding="0"></table>'+
//                         '<div><h5 class="pl6" style="margin:5px 0px;">筛选器逻辑编辑，不设置默认为AND例子 (1 AND 2) OR 3</h5><textarea class="form-control" name="sqlExpression"></textarea></div>'+
//                         '</div>'+
//                         '<div class="modal-footer textCenter"><button type="button" key="addConditionModal_save_btn" class="btn btn-primary">保存</button><button type="button" class="btn btn-default" data-dismiss="modal">关闭</button></div>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'+
//                         '<!-- 模态框（Modal）保存分线栏 -->'+
//                         '<div class="modal fade" name="addLineModal" tabindex="-1" role="dialog" aria-labelledby="addLineModalLabel" aria-hidden="true" data-backdrop="static">'+
//                         '<div class="modal-dialog">'+
//                         '<div class="modal-content">'+
//                         '<div class="modal-header modalColor" style="padding: 10px"><button type="button" class="close" data-miss="modal" aria-hidden="true">&times;</button><h5 class="modal-title" id="addLineModalLabel">分线栏</h5></div>'+
//                         '<div class="modal-body">'+
//                         '<form role="form" name="addLineForm" style="margin:20px 0 0 50px;">'+
//                         '<div class="form-group"><label class="queryLabel"><span>分线栏名称</span><span class="pl3">:</span></label><span class="pl9"><input type="hidden" name="classify_id"><input type="text" name="classify_name"></span></div>'+
//                         '</form>'+
//                         '</div>'+
//                         '<div class="modal-footer textCenter"><button type="button" key="addLineModal_save_btn" class="btn btn-primary">确定</button><button type="button" class="btn btn-default" data-dismiss="modal">取消</button></div>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'

//                 );
//             }
//         }
//     }

//     function fastSearch(divObj,tableObj,fieldList){
//         var me = this;
//         me.divObj = divObj;
//         me.tableObj=tableObj;
//         me.fieldList=fieldList;
//         me.quickQueryMagicSuggestList=[];
//         me.saveClassifySetting=function(closeModel){
//             var classifyList = me.tableObj.divObj.find("table[name=addClassTable]").find("tr");
//             var setting=[];
//             me.tableObj.divObj.find(".dropdown-content").find("li").not(":last,:first").remove();	//刷新搜索分类下拉选择列表
//             if(classifyList && classifyList.length>0){
//                 classifyList.each(function(i,obj){
//                     if($(obj).attr("key_id")){
//                         var classify={};
//                         classify.classifyId=$(obj).attr("key_id");
//                         classify.type=$(obj).hasClass("newPartingLine")?"line":"";
//                         if(classify.type){
//                             classify.name=$.trim($(obj).find("input[type=text]").val());
//                             me.tableObj.divObj.find(".dropdown-content").find("li:last").before('<li>'
//                             +'<div class="newPartingLine" style="height:40px;">'
//                             +'<div>'
//                             +'<label>'+classify.name+'</label>'
//                             +'</div>'
//                             +'</div></li>');
//                         }else{
//                             classify.name=$.trim($(obj).find("td:first").text());
//                             classify.isShow = $(obj).find(".div1").hasClass("close1");
//                             classify.isDefault = $(obj).find("input[name=default]").prop("checked");
//                             if(classify.isShow){
//                                 me.tableObj.divObj.find(".dropdown-content").find("li:last").before('<li key_id="'+classify.classifyId+'"><span>'+classify.name+'</span></li>');
//                             }
//                         }
//                         setting.push(classify);
//                     }
//                 });
//             }
//             var tableConditionSettingId=me.tableObj.divObj.find("input[name=tableConditionSettingId]").val();
//             $.post(ctx+"/cloud/sbehaviourConfig/use/saveConfig/TABLE_CONDITION_SETTING",{setting:JSON.stringify(setting),tableId:me.tableObj.tableId,id:tableConditionSettingId},function(json){
//                 if(json.result=="Success" || json.result=="SUCCESS"){
//                     me.tableObj.divObj.find("input[name=tableConditionSettingId]").val(json.map.obj.sid);
//                     if(closeModel){
//                         me.tableObj.divObj.find("div[name=addClassModal]").modal("hide");
//                         me.tableObj.divObj.find("div[name=addConditionModal]").modal("hide");
//                     }
//                 }else{
//                     tipsMsg(json.resultMsg,"FAIL");
//                 }
//             })
//         };
//         me.init=function(){
//             initHtml();
//             initEvent();
//             initQuickQuery(me.fieldList);

//             function initEvent(){
//                 me.divObj.find(".fastSearch_save_type").bind("click",function(){
//                     me.divObj.find("input[name=classify_name]").val('');
//                     $(me.divObj.find("div[name=saveQueryDataToClass]")[0]).modal('show');
//                 });
//                 me.divObj.find(".fastSearch_query").bind("click",function(){
//                     me.tableObj.search();
//                 });
//                 me.divObj.find(".fastSearch_clean").bind("click",function(){
//                     me.divObj.find(".queryForm")[0].reset();
//                     me.divObj.find(".queryForm").find(".selected").removeClass("selected");
//                     if(me.quickQueryMagicSuggestList && me.quickQueryMagicSuggestList.length>0){
//                         for(var i=0;i<me.quickQueryMagicSuggestList.length;i++){
//                             me.quickQueryMagicSuggestList[i].clear();
//                         }
//                     }
//                 });
//                 me.divObj.find(".fastSearch_save_type_submit_btn").bind("click",function(){
//                     saveQuickQuery();
//                 });
//             };

//             function initQuickQuery(fieldList){
//                 divObj.find(".queryForm").empty();
//                 $.each(fieldList,function(i,field){
//                     if(field.isShowSearch=="1"){
//                         var fieldHtml="";
//                         var condition="";
//                         if(field.setting){	//存在字段引用/字段转换
//                             var setting = JSON.parse(field.setting);
//                             if(!jQuery.isEmptyObject(setting.wordbook)){
//                                 condition="QUOTE";
//                                 fieldHtml+='<input type="text" name="temp" quote=\''+JSON.stringify(setting.wordbook)+'\' style="width:60%"/>';
//                             }else if(setting.showSetting && setting.showSetting.length>0){
//                                 condition="CONVERT";
//                                 for(var i=0;i<setting.showSetting.length;i++){
//                                     fieldHtml+='<span class="queryTitle" convert=\''+JSON.stringify(setting.showSetting[i].filter)+'\'>'+setting.showSetting[i].change_text+'</span>';
//                                 }
//                             }
//                         }else if("DATE,DATETIME".indexOf(field.fieldType)!=-1){
//                             fieldHtml+='<span class="queryTitle" condition="TODAY">今天</span>';
//                             fieldHtml+='<span class="queryTitle" condition="TOMORROW">明天</span>';
//                             fieldHtml+='<span class="queryTitle" condition="YESTERDAY">昨天</span>';
//                             fieldHtml+='<span class="queryTitle" condition="THIS_WEEK">本周</span>';
//                             fieldHtml+='<span class="queryTitle" condition="NEXT_WEEK">下周</span>';
//                             fieldHtml+='<span class="queryTitle" condition="UP_WEEK">上周</span>';
//                             fieldHtml+='<span class="queryTitle" condition="THIS_MONTH">本月</span>';
//                             fieldHtml+='<span class="queryTitle" condition="NEXT_MONTH">下月</span>';
//                             fieldHtml+='<span class="queryTitle" condition="UP_MONTH">上月</span>';
//                             fieldHtml+='<span class="queryTitle" condition="THIS_SEASON">本季度</span>';
//                             fieldHtml+='<span class="queryTitle" condition="NEXT_SEASON">下季度</span>';
//                             fieldHtml+='<span class="queryTitle" condition="UP_SEASON">上季度</span>';
//                             fieldHtml+='<span class="queryTitle" condition="THIS_YEAR">本年</span>';
//                             fieldHtml+='<span class="queryTitle" condition="NEXT_YEAR">下年</span>';
//                             fieldHtml+='<span class="queryTitle" condition="UP_YEAR">上年</span>';
//                             fieldHtml+='<span class="customTimeBtn customTime" style="background: #ddd;cursor: pointer;">选择时间</span>';
//                             fieldHtml+='<span class="customTime hide"><input type="text" name="start_val" class="time-date" style="width:105px;height:30px;" placeholder="开始时间"/></span>';
//                             fieldHtml+='<span class="customTime hide"><input type="text" name="end_val" class="time-date" style="width:105px;height:30px;" placeholder="截至时间"/></span>';
//                         }else if(field.fieldType=="TEXT"){
//                             condition="CL";
//                             fieldHtml+='<input type="text" name="value">';
//                         }else if(field.fieldType=="NUMBER"){
//                             condition="EQ";
//                             fieldHtml+='<input type="text" name="value">';
//                         }
//                         if(fieldHtml){
//                             divObj.find(".queryForm").append('<div class="form-group field-warp" field="'+field.columnName+'" condition="'+condition+'">'+
//                             '<label class="col-xs-3 queryLabel">'+
//                             '<span>'+field.title+'</span>'+
//                             '</label>'+
//                             '<div class="col-xs-9">'+
//                             fieldHtml+
//                             '</div>'+
//                             '</div>');
//                         }
//                     }
//                 });
//                 //字段引用使用多选搜索框
//                 divObj.find(".queryForm").find("div[condition=QUOTE] input[name=temp]").each(function(){
//                     var quoteStr=$(this).attr("quote");
//                     if(quoteStr){
//                         var quote=JSON.parse(quoteStr);
//                         var wordbookId=quote.id;
//                         var fieldKey=quote.field_key;
//                         var params={};
//                         if(quote.params){
//                             for(var i=0;i<quote.params.length;i++){
//                                 var p = quote.params[i];
//                                 if(p.p_name && p.p_value){
//                                     params[p.p_name]=p.p_value;
//                                 }
//                             }
//                         }
//                         if(wordbookId && fieldKey){
//                             var tempMagicSuggest=
//                                     $(this).magicSuggest({
//                                         data: ctx+"/cloud/table/list/reader/wordbook/"+wordbookId,
//                                         allowFreeEntries: false,
//                                         autoSelect:true,
//                                         dataUrlParams:params,
//                                         value:[],
//                                         valueField:fieldKey,
//                                         maxSelection:1000,//设置选择个数
//                                         placeholder: "请选择",
//                                         displayField:fieldKey,//定义显示的字段
//                                         maxSelectionRenderer:function(){
//                                             return "";
//                                         },
//                                         selectionRenderer:function(data){
//                                             var value=data[fieldKey];
//                                             return value;
//                                         }
//                                     });
//                             me.quickQueryMagicSuggestList.push(tempMagicSuggest);
//                         }
//                     }
//                 });
//                 //初始化日期输入框
//                 divObj.find(".queryForm").find(".time-date").each(function(i,obj){
//                     laydate.render({
//                         elem:obj //指定元素
//                     });
//                 });
//             }

//             function saveQuickQuery(){
//                 var classify_name=me.divObj.find("div[name=saveQueryDataToClass]").find("input[name=classify_name]").val();
//                 if(!classify_name){
//                     tipsMsg("请输入分类名称","FAIL");
//                     return;
//                 }
//                 var conObj=me.getQuickQueryConfig();
//                 if(conObj && conObj.length>0){
//                     var setting={name:classify_name,conObj:conObj};
//                     $.post(ctx+"/cloud/sbehaviourConfig/use/saveConfig/TABLE_CONDITION",{setting:JSON.stringify(setting),tableId:me.tableObj.tableId},function(json){
//                         if(json.result=="Success" || json.result=="SUCCESS"){
//                             me.tableObj.tableFilterxx.showClassify({classifyId:json.map.obj.sid,name:classify_name});
//                             var obj=json.map.obj;
//                             me.tableObj.conditionList[obj.sid]=obj;
//                             me.saveClassifySetting();
//                         }else{
//                             tipsMsg(json.resultMsg,"FAIL");
//                         }
//                     })
//                 }else{
//                     tipsMsg("没有任何搜索条件","FAIL");
//                 }
//                 me.divObj.find("div[name=saveQueryDataToClass]").modal("hide");
//             }

//             function initHtml(){
//                 me.divObj.append(
//                         '<div class="modal fade" name="queryModal" tabindex="-1" role="dialog" aria-labelledby="queryModalLabel" aria-hidden="true" data-backdrop="static">'+
//                         '<div class="modal-dialog">'+
//                         '<div class="modal-content">'+
//                         '<div class="modal-header modalColor" style="padding: 10px">'+
//                         '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'+
//                         '<h5 class="modal-title" id="queryModalLabel">快速查询</h5>'+
//                         '</div>'+
//                         '<div class="modal-body" style="min-height: 300px">'+
//                         '<form role="form" class="form-horizontal queryForm"></form>'+
//                         '</div>'+
//                         '<div class="modal-footer">'+
//                         '<button type="button" class="btn btn-primary fastSearch_save_type" data-toggle="modal" >保存到分类</button>'+
//                         '<button type="button" class="btn btn-primary fastSearch_query" data-dismiss="modal">查询</button>'+
//                         '<button type="button" class="btn btn-default fastSearch_clean" >清空</button>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'+
//                         '<!-- 模态框（Modal）保存查询到分类 -->'+
//                         '<div class="modal fade" name="saveQueryDataToClass" tabindex="-1" role="dialog" aria-labelledby="saveQueryDataToClassLabel" aria-hidden="true" data-backdrop="static">'+
//                         '<div class="modal-dialog">'+
//                         '<div class="modal-content">'+
//                         '<div class="modal-header modalColor" style="padding: 10px">'+
//                         '<button type="button" class="close" data-miss="modal" aria-hidden="true">&times;</button>'+
//                         '<h5 class="modal-title" id="saveQueryDataToClassLabel">快速查询</h5>'+
//                         '</div>'+
//                         '<div class="modal-body">'+
//                         '<form role="form" id="saveClass" style="margin:20px 0 0 50px;">'+
//                         '<div class="form-group">'+
//                         '<label class="queryLabel">'+
//                         '<span>分类名称</span>'+
//                         '</label>'+
//                         '<span class="pl9">'+
//                         '<input type="text" name="classify_name" class="form-control" maxlength="10">'+
//                         '</span>'+
//                         '</div>'+
//                         '</form>'+
//                         '</div>'+
//                         '<div class="modal-footer textCenter">'+
//                         '<button type="button"  class="btn btn-primary fastSearch_save_type_submit_btn">确定</button>'+
//                         '<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'+
//                         '</div>'
//                 );
//             }
//         };
//         me.getQuickQueryConfig=function (){
//             var configObj=[];
//             $.each(divObj.find(".queryForm").find(".form-group"),function(){
//                 obj=$(this);
//                 var field=obj.attr("field");
//                 var condition=obj.attr("condition");
//                 var con={field_key:field,con:condition};//value:value,end_val:end_val,start_val:start_val,unit:unit});
//                 if(!condition){	//日期类型
//                     condition = obj.find(".queryTitle.selected:first").attr("condition");;
//                     if(!condition){	//自定义
//                         var startVal=me.find("input[name=start_val]").val();
//                         var endVal=me.find("input[name=end_val]").val();
//                         if(!startVal && !endVal){
//                             return true;
//                         }
//                         con["con"]="IN";
//                         con["start_val"]=startVal;
//                         con["end_val"]=endVal;
//                     }else{
//                         con["con"]=condition;
//                     }
//                 }else if(condition=="CONVERT"){
//                     var convert=[];
//                     obj.find(".queryTitle.selected").each(function() {
//                         convert.push(JSON.parse($(this).attr("convert")));
//                     });
//                     if(convert.length==0){
//                         return true;
//                     }
//                     con["value"]=JSON.stringify(convert);
//                 }else if(condition=="QUOTE"){
//                     var value=obj.find("input[name='temp[]']").map(function() {
//                         return $(this).val();
//                     }).get().join("|#|");
//                     if(!value){
//                         return true;
//                     }
//                     con["value"]=value;
//                 }else{
//                     var value = obj.find("input[name=value]").val();
//                     if(!value){
//                         return true;
//                     }
//                     con["value"]=value;
//                 }
//                 configObj.push(con);
//             });
//             return configObj;
//         }
//     }

</script>

<script type="application/javascript" src="../../../../src/scripts/js/plug-in/zyupload/core/zyFile.js"></script>
<script type="application/javascript" src="../../../../src/scripts/js/plug-in/zyupload/control/js/zyUpload.js"></script>
<script src="../../../../src/scripts/js/plug-in/watermark/jquery.watermark.js"></script>
<script src="../../../../src/scripts/js/cloud/menu/home_page_common.js" type="text/javascript"></script>
<script src="../../../../src/scripts/js/jquery/checkTool.js"></script>


<script type="text/javascript">
//     var allPageList=[];
//     $(function(){
//         var pageConfig;
//         $.get(ctx+"/cloud/defined/page/getPageList",function(json){
//             if(json.result=="SUCCESS"){
//                 var defaultDb;
//                 if(json.map && json.map.isAdmin && json.map.isAdmin=="1"){
//                     isUserAdmin=true;
//                 }
//                 if(json.list && json.list.length>0){
//                     allPageList=json.list;
//                     var dataList = initShowPage(json.list);
//                     for(var i=0;i<dataList.length;i++){
//                         var db = dataList[i];
//                         if(db.default==1){
//                             defaultDb=db;
//                         }
//                         $("#homePageTable").find("tbody").append('<tr class="ui-sortable-handle"><td>'+db.name+'</td>' +
//                         '<td><input type="hidden" name="id" value="'+db.id+'">' +
//                         '<div class="div1 '+((db.isHide && db.isHide==1)?"open1":"close1")+'">'+
//                         '<span class="left"></span>'+
//                         '<span class="right"></span>'+
//                         '<div class="div2 '+((db.isHide && db.isHide==1)?"open2":"close2")+'"></div>'+
//                         '</div>'+
//                         '</td>' +
//                         '<td>' +
//                         '<span class="checkboxContent" style="position: relative;">'+
//                         '<input type="checkbox" name="default" '+((db.default && db.default=="1")?"checked":"")+'  id="'+db.id+'"/>'+
//                         '<label for="'+db.id+'"></label>'+
//                         '</span>'+
//                         '</td><td class="handler_td">'+
//                         '<span class="pointer pl12">'+
//                         '<img class="middle"  onclick="javascript:$(this).parent().parent().parent().remove();" src="../../../images/searchFilter/delete-selete.png" alt="删除"/>'+
//                         '</span>'+
//                         '<span class="pointer pl12">'+
//                         '<a href="/page/cloud/menu/definedPageEdit.html?id='+db.id+'"><img class="middle" src="../../../images/searchFilter/pencil-selete.png" alt="编辑" title="编辑" data-toggle="modal" data-target="#addConditionModal" key_id="'+db.id+'">'+
//                         '</span>'+
//                         '</td></tr>');
//                         if(!(db.isHide && db.isHide==1)){
//                             $(".selectPanel").append(
//                                     '<li role="presentation" key_id="'+db.id+'" key_title="'+db.name+'">' +
//                                     '<a class="panel-item" role="menuitem" tabindex="-1" href="#">'+
//                                     db.name+
// //                                    '<i class="operate-entrance" style="position: absolute; top:0;left:120px;font-size:16px;display: none;">' +
// //                                    '<i class="fa fa-angle-right"  style="margin-left:15px"></i>' +
// //                                    '</i>'+
//                                     '</a>'+
//                                     '</li>'
//                             );
//                         }
//                     }

//                 };

//                 $("#homePageTable").find("tbody").find("tr").each(function(i,obj){
//                     obj = $(obj);
//                     if(obj.find(".div1").hasClass("open1")){
//                         obj.find("input[name=default]").attr("disabled","disabled");
//                     }
//                 });
//                 $("#homePageTable").on('click','.div1',function() {
//                     $(this).toggleClass('close1');
//                     $(this).toggleClass('open1');
//                     $(this).find(".div2").toggleClass('close2');
//                     $(this).find(".div2").toggleClass('open2');
//                     if($(this).hasClass("open1")){
//                         if($(this).parent().parent().find("input[name=default]").prop("checked")){
//                             $(this).parent().parent().find("input[name=default]").attr("checked",false);
//                         }
//                         $(this).parent().parent().find("input[name=default]").attr("disabled","disabled");
//                     }else{
//                         $(this).parent().parent().find("input[name=default]").removeAttr("disabled");
//                     }
//                 });
//                 $("#homePageTable").on("click","input[name=default]",function(){
//                     if($(this).prop("checked")){
//                         $("#homePageTable").find("input[name=default]").not(this).prop("checked",false);
//                     }
//                 });
//                 $("#homePageTable").sortable({
//                     cursor:"pointer",
//                     items:"tr",
//                     opacity:0.6,
//                     delay:300,
//                     sort:true,
//                     disabled:false,
//                     revert:false,
//                     stop:function(event,ui){
//                     }
//                 });
//                 if($(".selectPanel").find("li").length>0){
//                     if(!defaultDb){
//                         for(var i=0;i<json.list.length;i++){
//                             if(!json.list[i].isHide){
//                                 defaultDb=json.list[i];
//                                 break;
//                             }
//                         }
//                     }
//                     $("#selectedPanel").attr("title",defaultDb.name);
//                     $("#selectedPanel").attr("key_id",defaultDb.id);
//                     $("#selectedPanel").text(defaultDb.name);
//                     initPage(defaultDb.id);
//                 }
//                 $(document).on("click",".dropdown-menu li",function(){
//                     $("#selectedPanel").attr("title",$(this).attr("key_title"));
//                     $("#selectedPanel").attr("key_id",$(this).attr("key_id"));
//                     $("#selectedPanel").text($(this).attr("key_title"));
//                     initPage($(this).attr("key_id"));
//                 })



//                 $(".dropdown-menu li").hover(function(){
//                     $(this).find(".operate-entrance").show();
//                 },function(){
//                     $(this).find(".operate-entrance").hide();
//                     $(this).find(".operate-panel").remove(); //鼠标移出时去掉编辑面板功能
//                 });
//                 $("#managerPanel").bind("click",function(){
//                     $("#managerHomePage").modal();
//                 });
//                 if(!isUserAdmin){
//                     $("#newPanel").remove();
//                     $("#homePageTable").find(".handler_td").remove();

//                 }
//             }else{
//                 Notify(json.resultMsg, 'top-right', '5000', 'success', 'fa-list', true);
//             }
//         });


//         $(document).on("click",".dropdown-menu li",function(){
//             $("#selectedPanel").attr("title",$(this).attr("key_title"));
//             $("#selectedPanel").attr("key_id",$(this).attr("key_id"));
//             $("#selectedPanel").text($(this).attr("key_title"));
//             initPage($(this).attr("key_id"));
//         })
//         function initShowPage(pageList){
//             getSetting();
//             var settingPageList = pageConfig;
//             for(var i=0;i<pageList.length;i++){
//                 var page=pageList[i];
//                 var index = 0;
//                 var defaultMark =0;
//                 var isHide=0;
//                 if(settingPageList && settingPageList[page.id]){
//                     index = (settingPageList[page.id].index && settingPageList[page.id].index>0)?(settingPageList[page.id].index):0;
//                     defaultMark = (settingPageList[page.id].default)?settingPageList[page.id].default:0;
//                     isHide = (settingPageList[page.id].isHide)?settingPageList[page.id].isHide:0;
//                 }
//                 page['index']=index;
//                 page['default']=defaultMark;
//                 page['isHide']=isHide;
//             }
//             pageList.sort(function(o1,o2){
//                 return o1.index - o2.index;
//             });
//             return pageList;
//         }

//         function getSetting(){
//             $.ajax({
//                 url:ctx+"/cloud/userUiConfig/getConfig",
//                 dataType:"json",
//                 async:false,
//                 type:"get",
//                 data:{tableId:"10001",type:"HOMEPAGE"},
//                 success:function (json) {
//                     if(json.result=="SUCCESS"){
//                         if(json.map && json.map.setting){
//                             var jsonObj = JSON.parse(json.map.setting);
//                             if(jsonObj && jsonObj.pageConfig && jsonObj.pageConfig){
//                                 pageConfig= jsonObj.pageConfig;
//                             }
//                         }
//                     }else{
//                         Notify(json.resultMsg, 'top-right', '5000', 'success', 'fa-list', true);
//                     }
//                 },
//                 error:function () {
//                     tipsMsg("删除失败","FAIL");
//                 }
//             });
//         }


//         function initPage(id){
//             $.get(ctx+"/cloud/defined/page/getPageById/"+id,function(json){
//                 if(json.result=="SUCCESS"){
//                     var oldItems = [];
//                     if(json.map && json.map.page){
//                         var page = json.map.page;
//                         var htmlText=page.htmlText;
//                         $("#parentContext").html(htmlText);
//                         extractConfig(id);
//                     }
//                 }else{
//                     Notify(json.resultMsg, 'top-right', '5000', 'success', 'fa-list', true);
//                 }
//             });
//         }
//     });

//     function extractConfig(pageId){
//         $(".config").each(function(i,obj){
//             var obj =$(obj);
//             var html= $.trim(obj.html());
//             var divObj = obj.parent();
//             if(html){
//                 var config =JSON.parse(html);
//                 config['pageId']=pageId;
//                 config.openWindow=openWindow;
//                 initobj = new initConfig(divObj,config,(pageId+"-"+i));
//                 initobj.init();
//             }
//         });
//     }

//     function submit(){
//         var data={};
//         $("#homePageTable .ui-sortable-handle").each(function(i,obj){
//             obj = $(obj);
//             var id = obj.find("input[name=id]").val();
//             var index = i;
//             var isDefault =$(obj).find("input[name=default]").prop("checked")?1:0;
//             var isHidden=$(obj).find(".div1").hasClass("open1")?1:0;
//             data[id]={id:id,index:index,default:isDefault,isHide:isHidden};
//         });
//         if(isUserAdmin){
//             var delIds = [];
//             for(var i=0;i<allPageList.length;i++){
//                 var db = allPageList[i];
//                 if(!(data[db.id] && data[db.id].id)){
//                     delIds.push(db.id);
//                 }
//             }
//             $.post(ctx+"/cloud/defined/page/saveSetting",{setting:JSON.stringify({"pageConfig":data}),tableId:10001,type:"HOMEPAGE",delIds:delIds.join(",")},function(json){
//                 if(json.result=="SUCCESS"){
// //                    tipsMsg("保存成功","SUCCESS");
//                     window.location.reload();
//                 }else{
//                     Notify(json.resultMsg, 'top-right', '5000', 'success', 'fa-list', true);
//                 }
//             });
//         }else{
//             $.post(ctx+"/cloud/userUiConfig/saveConfig",{setting:JSON.stringify({"pageConfig":data}),tableId:10001,type:"HOMEPAGE"},function(json){
//                 if(json.result=="SUCCESS"){
//                     tipsMsg("保存成功","SUCCESS");
//                     window.location.reload();
//                 }else{
//                     Notify(json.resultMsg, 'top-right', '5000', 'success', 'fa-list', true);
//                 }
//             });
//         }
//     }


</script>

<script type="text/javascript">

    // //悬浮在选择面板附近时，显示添加面板等入口
    // $(document).on("mouseenter", ".showLink", function () {
    //     $(".show-panel-operate").show();
    // });
    // $(document).on("mouseleave", ".showLink", function () {
    //     $(".show-panel-operate").hide();
    // });



    // $(".operate-entrance").click(function(){
    //     $("#oprate-panle").show();
    // });

    // //点击图标 按天查看等
    // $(".chart-nav-list li").click(function(){
    //     $(this).addClass("selected").siblings().removeClass("selected");
    // });
    // //点击筛选
    // $(".filter").click(function(){
    //     $("#queryModal").modal();
    // });

    // //点击设置
    // $(".setting").click(function(){
    //     $("#config").modal();
    // });

    // $(".select-panel").click(function(){
    //     $(".selectPanel").toggle();
    // })

</script>

<div id="prompt_fail" class="modal fade modal-statu" tabindex="-1" role="dialog" aria-hidden="true" style="display: none;">
    <div class="prompt-dialog" role="document">
        <div class="prompt-txt prompt-txt-fail"></div>
    </div>
</div>
</body>
</html>